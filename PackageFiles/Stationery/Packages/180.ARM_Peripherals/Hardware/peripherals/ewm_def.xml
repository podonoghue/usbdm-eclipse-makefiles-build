<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE peripheralPage SYSTEM "_menu.dtd" >
<!-- ewm_def.xml -->

<peripheralPage xmlns:xi="http://www.w3.org/2001/XInclude" name="_instance" description="External Watchdog Monitor">

   <xi:include href="_default_instance.xml"/>

   <xi:include href="_default_pcr.xml"/>
   
   <xi:include href="_mapPinsOption.xml"/>  
   
   <template><![CDATA[
      \t//! Pin number in Info table for EWM input if mapped to a pin
      \tstatic constexpr int inputPin  = 0;\n\n
      \t//! Pin number in Info table for EWM output if mapped to a pin
      \tstatic constexpr int outputPin  = 1;\n\n

      \t//! IRQ numbers for hardware
      \tstatic constexpr IRQn_Type irqNums[]  = $(_name)_IRQS;\n\n
   
      \t//! Number of IRQs for hardware
      \tstatic constexpr uint32_t irqCount  = sizeof(irqNums)/sizeof(irqNums[0]);\n\n
   ]]></template>

   <irqOption name="irqHandlingMethod"  
      description="Peripheral interrupt handler"
      toolTip="This selection allow the interrupt handler for this peripheral to be installed using several different methods"
      pattern="^WDOG%i_?$"
      classHandler="%c%i::irqHandler" />

   <!-- Template is added to class within pin_mapping.h -->
   <template><![CDATA[
       \t//! Class based callback handler has been installed in vector table\n
       \tstatic constexpr bool irqHandlerInstalled = $(irqHandlingMethod);\n\n
   ]]></template>
       
   <choiceOption name="irqLevel"
      description="Default IRQ level for this peripheral"
      toolTip="Sets the default priority level used to configure the NVIC">
      <choice name="VeryHigh"      value="NvicPriority_VeryHigh" />
      <choice name="High"          value="NvicPriority_High" />
      <choice name="MidHigh"       value="NvicPriority_MidHigh" />
      <choice name="Normal"        value="NvicPriority_Normal" isDefault="true"/>
      <choice name="Midlow"        value="NvicPriority_Midlow" />
      <choice name="Low"           value="NvicPriority_Low" />
      <choice name="VeryLow"       value="NvicPriority_VeryLow" />
   </choiceOption>

   <template><![CDATA[
       \t//! Default IRQ level\n
       \tstatic constexpr NvicPriority irqLevel =  $(?irqHandlingMethod:$(irqLevel):NvicPriority_NotInstalled);\n\n
   ]]></template>
   
   <xi:include href="_clockOption.xml"/>

   <projectActionList id = "ewm_files" >
      <copy source="Project_Headers/ewm.h"          target="Project_Headers/ewm.h"          overwrite="true" derived="true" />
      <copy source="Snippets/ewm-example.cpp"       target="Snippets/ewm-example.cpp"       overwrite="true" derived="true" />
   </projectActionList>
   
   <signals/>
   
</peripheralPage>
