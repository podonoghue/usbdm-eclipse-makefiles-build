<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE fragment SYSTEM "_menu.dtd" >
<!-- _sim_rtc_shared.xml -->

<fragment xmlns:xi="http://www.w3.org/2001/XInclude">
   
   <!-- Indicates whether OSC0/RTC(OSC1) share XTAL/EXTAL pins -->
   <constant key="rtcSharesPins" value="true" derived="true" />
   <stringOption key="rtc_shared" derived="true" hidden ="true" />
   

   <!-- Oscillator peripheral used for OSC0 input to MCG = OSC0 -->
   <!-- This peripheral is tied closely to the MCG              -->
   <constant key="osc0_peripheral"  value="/OSC0" derived="true" />
   <constant key="osc0_description" value="OSC0 - Main System Oscillator (OSCCLK0)" derived="true" />

   <!-- Uses RTC_CLKIN pin -->
   <intOption key="rtc_clkin_clock" 
      hidden="true"
      units="Hz"
      description="RTC_CLKIN pin"
      toolTip="External clock for the RTC (usually 32.768 kHz)"
      origin="RTC_CLKIN pin"
      value="0"
      min="0" max="33000" />

   <template><![CDATA[
      \t/** Frequency of clock provided to RTC clock-in pin */
      \tstatic constexpr uint32_t rtc_clkin_clock = $(rtc_clkin_clock);\n\n
   ]]></template>

   <for keys="n" dim="/SIM/numberOfClockSettings">
      <choiceOption key="mcg_c7_oscsel[%(n)]"
         target="mcg_erc_clock[%(n)]"
         hidden="true"
         description="MCG External reference clock" 
         toolTip="Source for MCG External Reference Clock">
         <choice value="0" ref="/OSC0/osc_clock"          name="OSC0 Clock"      />
      </choiceOption>

      <intOption key="mcg_erc_clock[%(n)]" 
         constant="true"
         hidden="true"
         units="Hz" 
         derived="true" 
         description="Frequency of MCG External reference"
         toolTip="External reference clock used by MCG" 
         value="32768" />
   </for>
   
   <!-- ERCCLK32K Sources -->
   <if condition="!sim_sopt1_osc32ksel" >
      <choiceOption key="sim_sopt1_osc32ksel"
         enumStem="SimOsc32kSel"
         target="system_erclk32k_clock"
         hidden="true"
         description="ERCLK32K clock source" 
         toolTip="Clock source for External 32k Reference Clock [ERCLK32K]">
         <choice value="0" name="OSC0 in low range (OSC32KCLK)"  ref="/OSC0/osc32k_clock"          enum="Osc32kClk" code="Osc0Info::getOsc32kClock()"  />
         <choice value="2" name="RTC_CLKIN pin"                  ref="/SIM/rtc_clkin_clock"        enum="RtcClkin"  code="rtc_clkin_clock"              />
         <choice value="3" name="LPO 1kHz clock"                 ref="/PMC/system_low_power_clock" enum="LpoClk"    code="1000"                           isDefault="true"/>
      </choiceOption>
   </if>
   
   <intOption key="system_erclk32k_clock" 
      hidden="true"
      constant="true"
      units="Hz" 
      derived="true" 
      description="Frequency of External 32k Reference Clock [ERCLK32K]"
      toolTip="External reference clock available to some peripherals (usually ~32kHz)" 
      origin="Derived from OSC32KCLK, RTC or LPO" 
      value="32768" />
      
   <if condition="!sim_sopt2_rtcclkoutsel" >
      <choiceOption key="sim_sopt2_rtcclkoutsel"
         enumStem="SimRtcClkoutSel"
         target="rtc_clkout" 
         hidden="true"
         description="RTC clock out [RTC_CLKOUT pin]"
         toolTip="Clock output on the RTC_CLKOUT pin">
         <choice value="0"  name="RTC 1 Hz clock"                  ref="/RTC/rtc_1hz_clock"      enum="1Hz"   />
         <choice value="1"  name="OSC32KCLK clock (from OSC0)"     ref="/OSC0/oscer_clock"       enum="32kHz" isDefault="true" />
   </choiceOption>
   </if>
   
   <intOption key="rtc_clkout"
      hidden="true"
      constant="true"
      derived="true"
      units="Hz"
      description="RTC clock out [RTC_CLKOUT pin]"
      toolTip="Clock frequency on the RTC_CLKOUT pin"  />
</fragment>
