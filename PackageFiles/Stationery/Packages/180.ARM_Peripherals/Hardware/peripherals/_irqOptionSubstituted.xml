<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE fragment SYSTEM "_menu.dtd" >
<!-- _irqOption.xml -->

<fragment xmlns:xi="http://www.w3.org/2001/XInclude">
   
   <!--
   Patterns for pattern and classHandler 
     -  %i replaced with peripheral instance e.g. FTM1 => 1, PTA => A
     -  %b replaced with peripheral base name e.g. FTM1 => = FTM
     -  %c replaced with peripheral C++ base class name e.g. FTM1 => = Ftm
     -  _IRQHandler is appended to the pattern (only)
   Multiple patterns and classsHandlers may be used separated by ';'
   -->
   <irqOption name="irqHandlingMethod"  
      description="Peripheral interrupt handler"
      toolTip="This selection allows the interrupt handler for this peripheral to be installed using several different methods"
      pattern="$(irq_pattern)" 
      classHandler="$(irq_classHandler)" />
      
   <choiceOption name="irqLevel"
      description="Default IRQ level for this peripheral"
      toolTip="Sets the default priority level used to configure the NVIC">
      <choice name="VeryHigh"      value="NvicPriority_VeryHigh" />
      <choice name="High"          value="NvicPriority_High" />
      <choice name="MidHigh"       value="NvicPriority_MidHigh" />
      <choice name="Normal"        value="NvicPriority_Normal" isDefault="true"/>
      <choice name="Midlow"        value="NvicPriority_Midlow" />
      <choice name="Low"           value="NvicPriority_Low" />
      <choice name="VeryLow"       value="NvicPriority_VeryLow" />
   </choiceOption>

   <template><![CDATA[
      \t/* Template_irqOptionSubstituted.xml */
      
      \t//! IRQ numbers for hardware
      \tstatic constexpr IRQn_Type irqNums[]  = $(_name)_IRQS;
   
      \t//! Number of IRQs for hardware
      \tstatic constexpr uint32_t irqCount  = sizeofArray(irqNums);

       \t//! Class based callback handler has been installed in vector table
       \tstatic constexpr bool irqHandlerInstalled = $(irqHandlingMethod);

       \t//! Default IRQ level
       \tstatic constexpr NvicPriority irqLevel =  $(?irqHandlingMethod:$(irqLevel):NvicPriority_NotInstalled);\n\n
   ]]></template>
      
   <constant name = "enable_interrupts_code"  derived = "true" value = "enableNvicInterrupts();"  />
   <constant name = "disable_interrupts_code" derived = "true" value = "disableNvicInterrupts();"  />

</fragment>
