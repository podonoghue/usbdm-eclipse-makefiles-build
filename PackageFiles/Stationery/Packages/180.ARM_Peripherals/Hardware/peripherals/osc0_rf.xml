<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE peripheralPage SYSTEM "_menu.dtd" >

<!--
      Predefined symbols generated for current peripheral
      _base_class FTM0 => Ftm
      _instance   FTM0 => 0
      _class      FTM0 => Ftm0
      _name       FTM0 => FTM0
 -->

<!-- osc0_rf.xml -->
<peripheralPage xmlns:xi="http://www.w3.org/2001/XInclude" name="_instance" description="Oscillator" >

   <xi:include href="_default_instance.xml"/>

   <xi:include href="_mapPinsOption_on.xml"/>

   <choiceOption key="rf_osc_en"
      description="RF Reference Oscillator Enable Select"
      toolTip="The oscillator can be enabled by a Radio link layer,\n
        by an internal SoC clock mode, by an External Pin request, or by this field">
         <choice value="0b0000"  name="RF Ref Osc will be controlled by the SoC, external pin, or a link layer" />
         <choice value="0b0001"  name="RF Ref Osc on in Run/Wait" isDefault="true"/>
         <choice value="0b0011"  name="RF Ref Osc on in Run/Wait/Stop" />
         <choice value="0b0111"  name="RF Ref Osc on in Run/Wait/Stop/VLPR/VLPW" />
         <choice value="0b1111"  name="RF Ref Osc on in Run/Wait/Stop/VLPR/VLPW/VLPS" />
      </choiceOption>

   <choiceOption key="osc_input_freq"
      target="osc_clock"
      units="Hz"
      description="Frequency of External Crystal"
      toolTip="Frequency of external crystal on RF_XTAL/RF_EXTAL pins">
         <choice value="26000000"  ref="26_MHz" name="26 MHz" />
         <choice value="32000000"  ref="32_MHz" name="32 MHz" isDefault="true" />
      </choiceOption>

   <intOption key="osc_clock"
      constant="true"
      derived="true"
      units="Hz"
      description="Frequency of RF oscillator"
      toolTip="Frequency of RF oscillator"
      value="32000000" />

   <choiceOption key="oscillatorRange"
      derived="true"
      constant="true"
      description="Oscillator Frequency Range Select"
      toolTip="This range value is determined from the crystal frequency.\n
               It some cases it may be unused and a range value suited to the FLL is used instead">
      <choice value="0" name="Low range" />
      <choice value="1" name="High range" />
      <choice value="2" name="Very High range" isDefault="true" />
      <choice value="0" name="Unconstrained by Oscillator" />
   </choiceOption>

   <intOption key="oscer_clock"
         ref="osc_clock"
         derived="true"
         units="Hz"
         description="Oscillator clock [OSCERCLK]"
         toolTip="Generated from osc_clock, available for peripherals"
         constant="true" />

   <validate
      class="net.sourceforge.usbdm.deviceEditor.validators.OscRfValidate">
   </validate>

   <projectActionList id = "osc_files" >
      <copy source="Project_Headers/osc_rf.h"  target="Project_Headers/osc.h"  overwrite="true"  derived="true" />
   </projectActionList>

   <template><![CDATA[
      \t//! RF Reference Oscillator Enable Select
      \tstatic constexpr uint32_t rf_osc_en = $(rf_osc_en)UL;

      \t//! Frequency of OSC Clock or Crystal
      \tstatic constexpr uint32_t osc_clock = $(osc_clock)UL;

      \t/**
      \t * Get OSC clock (internal, assumed available)
      \t *
      \t * @return Clock frequency as uint32_t in Hz
      \t */
      \tstatic constexpr uint32_t getOscClock() {
      \t   return osc_clock;
      \t}

      \t/**
      \t * Get OSC clock (external)
      \t *
      \t * @return Clock frequency as uint32_t in Hz
      \t */
      \tstatic uint32_t getOscerClock() {
      \t   return osc_clock;
      \t}\n\n
   ]]></template>

   <template key="/OSC_RF/declarations" namespace="all"  ><![CDATA[
   \t/**
   \t * Class representing $(_name)
   \t */
   \tclass $(_class) : public $(_base_class)Base_T<$(_class)Info> {};\n
   ]]></template>

   <template key="/MCG/Includes" namespace="all"  ><![CDATA[
   #include "osc.h"\n
   ]]></template>

   <template key="/MCG/Initialisation" namespace="all"  ><![CDATA[
   \tUSBDM::$(_class)::initialise();\n
   ]]></template>

   <signals />
</peripheralPage>
