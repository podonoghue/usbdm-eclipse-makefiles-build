<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE peripheralPage SYSTEM "_menu.dtd" >
<!-- sim_mk65f18.xml -->

<peripheralPage xmlns:xi="http://www.w3.org/2001/XInclude" name="_instance" description="SIM">
    
   <xi:include href="_default_instance.xml"/>

   <xi:include href="_simCommon.xml"/>

   <!-- Indicate RTC arrangement: OSC0/RTC(OSC1) does not share XTAL/EXTAL pins -->
   <constant key="rtc_independent" />

   <intOption key="system_irc48m_clock" 
      constant="true"  
      hidden="true"
      units="Hz"
      description="Frequency of Internal 48MHz Clock [IRC48MCLK]"
      toolTip="48 MHz Internal Oscillator [May be trimmed against USB bus]"
      origin="48MHz clock from IRC48MCLK"
      value="48000000"/>

   <intOption key="system_usb_clkin_clock"  
      constant="true" 
      hidden="true"
      origin="USB Clock In pin"
      units="Hz"
      description="Frequency of External USB Clock"
      toolTip="Externally provided clock for USB on USB_CLKIN" 
      value="0" />

   <category name="SOPT1" description="RTC clocks" >

      <choiceOption key="sim_sopt1_osc32ksel" 
         description="ERCLK32K source" 
         toolTip="Clock source of External 32k Reference Clock [ERCLK32K]\n
            Used by LPTMR">
         <choice value="0" name="System oscillator in low range (OSC32KCLK)" />
         <choice value="1" name="Reserved" />
         <choice value="2" name="RTC 32kHz clock" />
         <choice value="3" name="LPO 1kHz clock"  isDefault="true"/>
      </choiceOption>

      <intOption key="system_erclk32k_clock" 
         constant="true"
         units="Hz" 
         derived="true" 
         description="Frequency of External 32k Reference Clock [ERCLK32K]"
         toolTip="External reference clock available to some peripherals (usually ~32kHz)" 
         origin="Derived from OSC32KCLK, RTCCLK or LPO" 
         value="32768" />
      
   </category>

   <category name="SOPT2" description="Clock Gating">
      <binaryOption key="sim_sopt2_rtcclkoutsel" 
         description="RTC clock out select [RTC_CLKOUT pin]"
         toolTip="Clock output on the RTC_CLKOUT pin">
         <choice value="0"  name="RTC 1 Hz clock" />
         <choice value="1"  name="RTC 32kHz clock" isDefault="true" />
      </binaryOption>
      
      <intOption key="rtc_clkout"
         constant="true"
         derived="true"
         units="Hz"
         description="RTC clock out [RTC_CLKOUT pin]"
         toolTip="Clock frequency on the RTC_CLKOUT pin"  />
      
      <aliasOption key="/SIM/sim_sopt2_pllfllsel[]" constant="false" />
      
      <aliasOption key="/SIM/system_peripheral_clock[]" />
      
      <aliasOption key="/SIM/sim_sopt2_usbsrc[]" />
      <aliasOption key="/SIM/system_usbfs_clock[]" />

      <stringOption key="Uart0Clock" description="Uart 0 clock" value="SystemCoreClock" constant="true" derived="true" />
      <stringOption key="Uart1Clock" description="Uart 1 clock" value="SystemCoreClock" constant="true" derived="true" />
      <stringOption key="Uart2Clock" description="Uart 2 clock" value="SystemBusClock"  constant="true" derived="true" />
      <stringOption key="Uart3Clock" description="Uart 3 clock" value="SystemBusClock"  constant="true" derived="true" />
      <stringOption key="Uart4Clock" description="Uart 4 clock" value="SystemBusClock"  constant="true" derived="true" />
      <stringOption key="Uart5Clock" description="Uart 5 clock" value="SystemBusClock"  constant="true" derived="true" />
      
      <choiceOption key="sim_sopt2_fbsl" 
         enumStem="SimFlexbusSecurity"
         description="FlexBus off-chip access security level"
         toolTip="Permitted CPU accesses off-chip via the FlexBus interface" >
         <choice value="0"  name="None - All accesses are disallowed"                enum="None"     />
         <choice value="2"  name="Data - Data only accesses allowed"                 enum="DataOnly" />
         <choice value="3"  name="All - Data and instruction accesses are allowed"   enum="All"      />
      </choiceOption>
      
      <intOption key="system_sdhc_clockin" condition="sim_sopt2_sdhcsrc_present"
         origin="SDHC Clock In pin"
         units="Hz"
         description="Frequency of External SDHC Clock"
         toolTip="Externally provided clock for SDHC" 
         value="0" />

      <choiceOption key="sim_sopt2_sdhcsrc" condition="sim_sopt2_sdhcsrc_present"
         target="system_sdhc_clock"
         enumStem="SimSdhcClockSource"
         description="SDHC Clock select"
         toolTip="Selects the clock source for the SDHC clock" >
         <choice value="0"  name="Core/system clock"            ref="system_core_clock"       enum="CoreClk"         code="SystemCoreClock"          isDefault="true" />
         <choice value="1"  name="Peripheral Clock"             ref="system_peripheral_clock" enum="PeripheralClk"   code="getPeripheralClock()" />
         <choice value="2"  name="OSCERCLK clock"               ref="/OSC0/oscer_clock"       enum="OscerClk"        code="Osc0Info::getOscerClock()" />
         <choice value="3"  name="External clock (SDHC0_CLKIN)" ref="system_sdhc_clockin"     enum="External"        code="sdhcExternalClock" />
      </choiceOption>
      
      <intOption key="system_sdhc_clock" condition="sim_sopt2_sdhcsrc_present"
         constant="true"
         derived="true"
         units="Hz"
         description="SDHC Clock frequency (not implemented)"
         toolTip="Frequency of clock to SDHC"
         value="0" max="120MHz" />
         
      <choiceOption key="sim_sopt2_clkoutsel" condition="sim_sopt2_clkoutsel_present"
         enumStem="SimClkoutSel"
         description="CLKOUT pin clock"
         toolTip="Clock to output on the CLKOUT pin" >
         <choice value="0"  name="FlexBus CLKOUT"      enum="FlexBusClk"    />
         <choice value="2"  name="Flash clock"         enum="FlashClk" isDefault="true" />
         <choice value="3"  name="LPO clock (1 kHz)"   enum="LpoClk"       />
         <choice value="4"  name="MCGIRCLK"            enum="McgIrClk"     />
         <choice value="5"  name="RTC 32.768kHz clock" enum="RtcClk"       />
         <choice value="6"  name="OSCERCLK0"           enum="OscerClk0"    />
         <choice value="7"  name="IRC 48 MHz clock"    enum="Irc48MClk" condition="system_irc48m_clock" />
      </choiceOption>
      
      <binaryOption key="sim_sopt2_ptd7pad" 
         enumStem="simPortDPad"
         description="PTD7 pad drive strength"
         toolTip="Controls the output drive strength of the PTD7 pin\n
                  by selecting either one or two pads to drive it" >
         <choice value="0"  name="Single-pad drive strength" isDefault="true" />
         <choice value="1"  name="Double-pad drive strength" />
      </binaryOption>   
      
      <binaryOption key="sim_sopt2_rmiisrc" 
         description="RMII clock source select"
         toolTip="Selects the clock source for the Ethernet RMII interface">
         <choice value="0"  name="EXTAL clock" isDefault="true" />
         <choice value="1"  name="External bypass clock (ENET_1588_CLKIN)" />
      </binaryOption>

      <choiceOption key="sim_sopt2_timesrc" 
         description="IEEE 1588 timestamp clock source select"
         toolTip="Selects the clock source for the Ethernet RMII interface">
         <choice value="0"  name="Core/system clock" isDefault="true" />
         <choice value="1"  name="Peripheral Clock" />
         <choice value="3"  name="OSCERCLK Clock" />
         <choice value="4"  name="External bypass clock (ENET_1588_CLKIN)" />
      </choiceOption>
      
      <binaryOption key="sim_sopt2_traceclksel" condition="sim_sopt2_traceclksel_present"
         enumStem="SimTraceClockoutSel"
         description="Debug trace clock select"
         toolTip="Selects the core/system clock or MCG output clock (MCGOUTCLK)\n
             as the trace clock source" >
         <choice value="0"  name="MCGOUTCLK"          enum="McgOutClk"  isDefault="true" />
         <choice value="1"  name="Core/system clock"  enum="CoreClk"    />
      </binaryOption>   
   </category>
   
   <category name="SOPT4" description="FTM signals">
      <binaryOption key="sim_sopt4_ftm3trg1src" 
         description="FlexTimer 3 Hardware Trigger 1 Source Select"
         toolTip="Selects the source of FTM hardware trigger 1" >
         <choice value="0"  name="Reserved" />
         <choice value="1"  name="FTM2 channel match" isDefault="true" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm3trg0src" 
         description="FlexTimer 3 Hardware Trigger 0 Source Select"
         toolTip="Selects the source of FTM hardware trigger 0" >
         <choice value="0"  name="Reserved" />
         <choice value="1"  name="FTM1 channel match" isDefault="true" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm0trg1src" 
         description="FlexTimer 0 Hardware Trigger 1 Source Select"
         toolTip="Selects the source of FTM hardware trigger 1" >
         <choice value="0"  name="PDB output trigger 1" isDefault="true" />
         <choice value="1"  name="FTM2 channel match" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm0trg0src" 
         description="FlexTimer 0 Hardware Trigger 0 Source Select"
         toolTip="Selects the source of FTM hardware trigger 0" >
         <choice value="0"  name="CMP0 output" isDefault="true" />
         <choice value="1"  name="FTM1 channel match" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm3clksel" 
         description="FlexTimer 3 External Clock Pin Select"
         toolTip="Selects the external pin used to drive the clock to the FTM module">
         <choice value="0"  name="FTM_CLKIN0 pin" isDefault="true" />
         <choice value="1"  name="FTM_CLKIN1 pin" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm2clksel" 
         description="FlexTimer 2 External Clock Pin Select"
         toolTip="Selects the external pin used to drive the clock to the FTM module">
         <choice value="0"  name="FTM_CLKIN0 pin" isDefault="true" />
         <choice value="1"  name="FTM_CLKIN1 pin" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm1clksel" 
         description="FlexTimer 1 External Clock Pin Select"
         toolTip="Selects the external pin used to drive the clock to the FTM module">
         <choice value="0"  name="FTM_CLKIN0 pin" isDefault="true" />
         <choice value="1"  name="FTM_CLKIN1 pin" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm0clksel" 
         description="FlexTimer 0 External Clock Pin Select"
         toolTip="Selects the external pin used to drive the clock to the FTM module">
         <choice value="0"  name="FTM_CLKIN0 pin" isDefault="true" />
         <choice value="1"  name="FTM_CLKIN1 pin" />
      </binaryOption>
      
      <choiceOption key="sim_sopt4_ftm2ch0src" 
         description="FlexTimer 2 channel 0 input capture source select"
         toolTip="Selects the source for FTM channel 0 input capture\n
            NOTE: When the FTM is not in input capture mode, clear this field">
         <choice value="0" name="FTM2_CH0 signal"  isDefault="true"/>
         <choice value="1" name="CMP0 output" />
         <choice value="2" name="CMP1 output" />
         <choice value="3" name="Reserved" />
      </choiceOption>
      
      <choiceOption key="sim_sopt4_ftm1ch0src" 
         description="FlexTimer 1 channel 0 input capture source select"
         toolTip="Selects the source for FTM channel 0 input capture\n
            NOTE: When the FTM is not in input capture mode, clear this field">
         <choice value="0" name="FTM1_CH0 signal"  isDefault="true"/>
         <choice value="1" name="CMP0 output" />
         <choice value="2" name="CMP1 output" />
         <choice value="3" name="USB start of frame pulse" />
      </choiceOption>
      
      <binaryOption key="sim_sopt4_ftm3flt0" 
         description="FlexTimer 3 Fault 0 Select"
         toolTip="Selects the source of FTM fault 0" >
         <choice value="0"  name="FTM3_FLT0 pin" isDefault="true" />
         <choice value="1"  name="CMP0 output" />
      </binaryOption>
   
      <binaryOption key="sim_sopt4_ftm2flt0" 
         description="FlexTimer 2 Fault 0 Select"
         toolTip="Selects the source of FTM fault input  0" >
         <choice value="0"  name="FTM2_FLT0 pin" isDefault="true" />
         <choice value="1"  name="CMP0 output" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm1flt0" 
         description="FlexTimer 1 Fault 0 Select"
         toolTip="Selects the source of FTM fault input 0" >
         <choice value="0"  name="FTM1_FLT0 pin" isDefault="true" />
         <choice value="1"  name="CMP0 output" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm0flt2" 
         description="FlexTimer 0 Fault 2 Select"
         toolTip="Selects the source of FTM fault input 2" >
         <choice value="0"  name="FTM0_FLT2 pin" isDefault="true" />
         <choice value="1"  name="CMP2 output" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm0flt1" 
         description="FlexTimer 0 Fault 1 Select"
         toolTip="Selects the source of FTM fault input 1" >
         <choice value="0"  name="FTM0_FLT1 pin" isDefault="true" />
         <choice value="1"  name="CMP1 output" />
      </binaryOption>
      
      <binaryOption key="sim_sopt4_ftm0flt0" 
         description="FlexTimer 0 Fault 0 Select"
         toolTip="Selects the source of FTM fault input 0" >
         <choice value="0"  name="FTM0_FLT0 pin" isDefault="true" />
         <choice value="1"  name="CMP0 output" />
      </binaryOption>
   </category>
   
   <category name="SOPT5" description="UART signals">
      <choiceOption key="sim_sopt5_uart0txsrc" 
         description="UART 0 transmit data source select"
         toolTip="Selects the source for the UART 0 transmit data">
         <choice value="0" name="UART0_TX pin" isDefault="true" />
         <choice value="1" name="UART0_TX pin modulated with FTM1 channel 0 output" />
         <choice value="2" name="UART0_TX pin modulated with FTM2 channel 0 output" />
         <choice value="3" name="Reserved" />
      </choiceOption>
      
      <choiceOption key="sim_sopt5_uart0rxsrc" 
         description="UART 0 receive data source select"
         toolTip="Selects the source for the UART 0 receive data">
         <choice value="0" name="UART0_RX pin" isDefault="true" />
         <choice value="1" name="CMP0 output" />
         <choice value="2" name="CMP1 output" />
         <choice value="3" name="Reserved" />
      </choiceOption>
      
      <choiceOption key="sim_sopt5_uart1txsrc" 
         description="UART 1 transmit data source select"
         toolTip="Selects the source for the UART 1 transmit data">
         <choice value="0" name="UART1_TX pin" isDefault="true" />
         <choice value="1" name="UART1_TX pin modulated with FTM1 channel 0 output" />
         <choice value="1" name="UART1_TX pin modulated with FTM2 channel 0 output" />
         <choice value="3" name="Reserved" />
      </choiceOption>
      
      <choiceOption key="sim_sopt5_uart1rxsrc" 
         description="UART 1 receive data source select"
         toolTip="Selects the source for the UART 1 receive data">
         <choice value="0" name="UART1_RX pin" isDefault="true" />
         <choice value="1" name="CMP0 output" />
         <choice value="2" name="CMP1 output" />
         <choice value="3" name="Reserved" />
      </choiceOption>
   </category>

   <category name="SOPT7" description="ADC signals">
      <for keys="adc" values="0;1"> 
         <choiceOption key="sim_sopt7_adc%(adc)trigger" condition="sim_sopt7_adc%(adc)alttrgen_present"
            enumStem="SimAdc%(adc)TriggerMode"
            valueFormat="SIM_SOPT7_ADC%(adc)ALTTRGEN(%s),SIM_SOPT7_ADC%(adc)PRETRGSEL(%s)"
            description="ADC%(adc) trigger mode"
            toolTip="Alternative conversion triggers for ADC\n 
               _Pdb              - ADC is triggered by PDB\n
               _Alt_PreTrigger_0 - ADC is triggered by SimAdc%(adc)Trigger selection and uses pretrigger 0 = A (SC1[0]/R[0])\n
               _Alt_PreTrigger_1 - ADC is triggered by SimAdc%(adc)Trigger selection and uses pretrigger 1 = B (SC1[1]/R[1])" >
            <choice value="0,0"   name="Triggered by PDB"             enum="Pdb" isDefault="true" />
            <choice value="1,0"   name="Pre-trigger 0 = A (SC1[0])"   enum="Alt_PreTrigger_0" />
            <choice value="1,1"   name="Pre-trigger 1 = B (SC1[1])"   enum="Alt_PreTrigger_1" />
         </choiceOption>
      
         <choiceOption key="sim_sopt7_adc%(adc)trgsel" condition="sim_sopt7_adc%(adc)pretrgsel_present"
            enumStem="SimAdc%(adc)TriggerSrc"
            description="ADC%(adc) trigger source"
            toolTip="ADC Trigger source in STOP and VLPS modes, or when ADC Alternative Trigger is active">
            <choice value="0"  name="External trigger pin input (PDB0_EXTRG)" enum="External"     isDefault="true" />
            <choice value="1"  name="CMP 0 output"                            enum="Cmp0"         condition="/CMP0/$present"   />
            <choice value="2"  name="CMP 1 output"                            enum="Cmp1"         condition="/CMP1/$present"   />
            <choice value="3"  name="CMP 2 output"                            enum="Cmp2"         condition="/CMP2/$present"   />
            <choice value="4"  name="PIT trigger 0"                           enum="PitCh0"       condition="/PIT/$present"    />
            <choice value="5"  name="PIT trigger 1"                           enum="PitCh1"       condition="/PIT/$present"    />
            <choice value="6"  name="PIT trigger 2"                           enum="PitCh2"       condition="/PIT/$present"    />
            <choice value="7"  name="PIT trigger 3"                           enum="PitCh3"       condition="/PIT/$present"    />
            <choice value="8"  name="FTM0 trigger"                            enum="Ftm0"         condition="/FTM0/$present"   />
            <choice value="9"  name="FTM1 trigger"                            enum="Ftm1"         condition="/FTM1/$present"   />
            <choice value="10" name="FTM2 trigger"                            enum="Ftm2"         condition="/FTM2/$present"   />
            <choice value="11" name="FTM3 trigger"                            enum="Ftm3"         condition="/FTM3/$present"   />
            <choice value="12" name="RTC alarm"                               enum="RtcAlarm"     condition="/RTC/$present"    />
            <choice value="13" name="RTC seconds"                             enum="RtcSeconds"   condition="/RTC/$present"    />
            <choice value="14" name="LPTMR trigger"                           enum="Lptmr"        condition="/LPTMR0/$present" />
            <choice value="15" name="TPM1 channel 0/1 (A/B pretrigger)"       enum="Tmp1Triggers" condition="/TPM1/$present"/>
         </choiceOption>
      </for>      
   </category>
    
   <for keys="n" dim="/SIM/numberOfClockSettings" >
      <aliasCategoryOption key="/MCG/ClockConfig[%(n)]" derived="true" constant="true" >
      
         <aliasOption key="/MCG/enableClockConfiguration[%(n)]" constant="false" />
         <aliasOption key="/SMC/smc_pmctrl_runm[%(n)]"          constant="false" />

         <choiceOption key="sim_sopt2_pllfllsel[%(n)]"
            enumStem="SimPeripheralClockSource"
            target="system_peripheral_clock[%(n)]"
            description="Peripheral Clock"
            toolTip="Clock for various peripherals (LPUART, TPM etc.)">
            <choice value="0"  name="MCGFLLCLK clock"   ref="/MCG/system_mcgfllclk_clock[%(n)]"    enum="McgFllClk"  code="SystemMcgFllClock"   isDefault="true" />
            <choice value="1"  name="MCGPLLCLK clock"   ref="/MCG/system_mcgpllclk_clock[%(n)]"    enum="McgPllClk"  code="SystemMcgPllClock"   />
            <choice value="3"  name="IRC48 MHz clock"   ref="/SIM/system_irc48m_clock"             enum="Irc48mClk"  code="irc48mClock"         condition="system_irc48m_clock" />
         </choiceOption>
   
         <intOption key="system_peripheral_clock[%(n)]"
            derived="true"
            constant="true"
            units="Hz"
            description="Peripheral Clock frequency"
            toolTip="Frequency of Peripheral Clock available to various peripherals"  />
	 
         <choiceOption key="sim_clkdiv2_usb[%(n)]" condition="sim_clkdiv2_usbdiv_present"
            valueFormat="(%s)"
            target="clkdiv2_clock[%(n)]"
            enumStem="SimUsbClockDivider"
            description="USB clock divider (SIM_CLKDIV2)" 
            toolTip="Sets the clock divider when using an internal clock\n
                     as the USB clock source">
            <choice value="1"  name="Multiply by 2 (div=0, frac=1)"  enum="Mult2 " ref="(system_peripheral_clock[%(n)]*2/1)" code="SIM_CLKDIV2_USBDIV(0)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="0"  name="Multiply by 1 (div=0, frac=0)"  enum="Mult1 " ref="(system_peripheral_clock[%(n)]*1/1)" code="SIM_CLKDIV2_USBDIV(0)|SIM_CLKDIV2_USBFRAC(0)" isDefault="true" />
            <choice value="3"  name="Multiply by 1 (div=1, frac=1)"  enum="Mult1b" ref="(system_peripheral_clock[%(n)]*2/2)" code="SIM_CLKDIV2_USBDIV(1)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="5"  name="Divide by 1.5 (div=2, frac=1)"  enum="Div1_5" ref="(system_peripheral_clock[%(n)]*2/3)" code="SIM_CLKDIV2_USBDIV(2)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="2"  name="Divide by 2 (div=1, frac=0)"    enum="Div2  " ref="(system_peripheral_clock[%(n)]*1/2)" code="SIM_CLKDIV2_USBDIV(1)|SIM_CLKDIV2_USBFRAC(0)" />
            <choice value="7"  name="Divide by 2 (div=3, frac=1)"    enum="Div2b " ref="(system_peripheral_clock[%(n)]*2/4)" code="SIM_CLKDIV2_USBDIV(2)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="9"  name="Divide by 2.5 (div=4, frac=1)"  enum="Div2_5" ref="(system_peripheral_clock[%(n)]*2/5)" code="SIM_CLKDIV2_USBDIV(4)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="4"  name="Divide by 3 (div=2, frac=0)"    enum="Div3  " ref="(system_peripheral_clock[%(n)]*1/3)" code="SIM_CLKDIV2_USBDIV(5)|SIM_CLKDIV2_USBFRAC(0)" />
            <choice value="11" name="Divide by 3 (div=5, frac=1)"    enum="Div3b " ref="(system_peripheral_clock[%(n)]*2/6)" code="SIM_CLKDIV2_USBDIV(5)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="13" name="Divide by 3.5 (div=6, frac=1)"  enum="Div3_5" ref="(system_peripheral_clock[%(n)]*2/7)" code="SIM_CLKDIV2_USBDIV(6)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="6"  name="Divide by 4 (div=3, frac=0)"    enum="Div4  " ref="(system_peripheral_clock[%(n)]*1/4)" code="SIM_CLKDIV2_USBDIV(3)|SIM_CLKDIV2_USBFRAC(0)" />
            <choice value="15" name="Divide by 4 (div=7, frac=1)"    enum="Div4b " ref="(system_peripheral_clock[%(n)]*2/8)" code="SIM_CLKDIV2_USBDIV(7)|SIM_CLKDIV2_USBFRAC(1)" />
            <choice value="8"  name="Divide by 5 (div=4, frac=0)"    enum="Div5  " ref="(system_peripheral_clock[%(n)]*1/5)" code="SIM_CLKDIV2_USBDIV(4)|SIM_CLKDIV2_USBFRAC(0)" />
            <choice value="10" name="Divide by 6 (div=5, frac=0)"    enum="Div6  " ref="(system_peripheral_clock[%(n)]*1/6)" code="SIM_CLKDIV2_USBDIV(5)|SIM_CLKDIV2_USBFRAC(0)" />
            <choice value="12" name="Divide by 7 (div=6, frac=0)"    enum="Div7  " ref="(system_peripheral_clock[%(n)]*1/7)" code="SIM_CLKDIV2_USBDIV(6)|SIM_CLKDIV2_USBFRAC(0)" />
            <choice value="14" name="Divide by 8 (div=7, frac=0)"    enum="Div8  " ref="(system_peripheral_clock[%(n)]*1/8)" code="SIM_CLKDIV2_USBDIV(7)|SIM_CLKDIV2_USBFRAC(0)" />
         </choiceOption>
   
         <intOption key="clkdiv2_clock[%(n)]"  condition="sim_clkdiv2_usbdiv_present"
            hidden="true"
            derived="true"
            constant="true"
            units="Hz"
            description="USB Full Speed Clock"
            toolTip="Frequency of clock to USB full speed controller"
            value="0" />
    
         <choiceOption key="sim_sopt2_usbsrc[%(n)]" condition="sim_sopt2_usbsrc_present"
            target="system_usbfs_clock[%(n)]"
            enumStem="SimUsbFullSpeedClockSource"
            description="USB Clock"
            toolTip="Source for the USB clock">
            <choice value="0"  name="External bypass clock (USB_CLKIN)" enum="External"      ref="system_usb_clkin_clock" />
            <choice value="1"  name="Peripheral Clock/SIM_CLKDIV2"      enum="PeripheralClk" ref="clkdiv2_clock[%(n)]"    isDefault="true" />
         </choiceOption>
      
         <aliasOption key="system_usb_clkin_clock" constant="false" />
         
         <intOption key="system_usbfs_clock[%(n)]"  condition="sim_sopt2_usbsrc_present"
            errorPropagate="error"
            derived="true"
            constant="true"
            units="Hz"
            description="USB Full Speed Clock"
            toolTip="Frequency of clock to USB full speed controller"
            value="48 MHz" min="48 MHz" max="48 MHz" />
    
    
         <aliasOption key="/MCG/system_mcgoutclk_clock[%(n)]" />

         <intOption key="system_core_clock[%(n)]" condition="sim_clkdiv1_outdiv1_present"
            ref="(/MCG/system_mcgoutclk_clock[%(n)])/(sim_clkdiv1_outdiv1[%(n)])"
            derived="true"
            isNamedClock="true"
            units="Hz"
            description="System Core Clock"
            toolTip="Clocks the ARM Cortex-M4 core and bus masters"
            value="120 MHz" />
      
         <intOption key="system_bus_clock[%(n)]" condition="sim_clkdiv1_outdiv2_present" 
            ref="(/MCG/system_mcgoutclk_clock[%(n)])/(sim_clkdiv1_outdiv2[%(n)])"
            derived="true"
            isNamedClock="true"
            units="Hz"
            description="System Bus Clock"
            toolTip="Clocks the bus slaves and peripherals\n
                     Must be &lt;= Core Clock frequency and an integer divisor"
            value="60 MHz" />
   
         <intOption key="system_flexbus_clock[%(n)]" condition="sim_clkdiv1_outdiv3_present" 
            ref="(/MCG/system_mcgoutclk_clock[%(n)])/(sim_clkdiv1_outdiv3[%(n)])"
            derived="true"
            isNamedClock="true"
            units="Hz"
            description="System Flexbus Clock"
            toolTip="Clocks the flexbus interface\n
                     Must be &lt;= Bus Clock frequency"
            value="60 MHz" />
      
         <intOption key="system_flash_clock[%(n)]" condition="sim_clkdiv1_outdiv4_present" 
            ref="(/MCG/system_mcgoutclk_clock[%(n)])/(sim_clkdiv1_outdiv4[%(n)])"
            derived="true"
            isNamedClock="true"
            units="Hz"
            description="System Flash Clock"
            toolTip="Clocks the flash memory\n
                     Must be an integer divisor of the Core Clock.\n
                     Must be &lt;= Bus Clock frequency[%(n)]\n
                     Must be &gt;= Core clock / 8"
            value="24 MHz" />
      
         <category name="CLKDIV1" description="System Clock Dividers">
            <intOption key="sim_clkdiv1_outdiv1[%(n)]"  condition="sim_clkdiv1_outdiv1_present"
               constant="true"
               description="Core &amp; System Clock Divider (OUTDIV1) - Divide by [1-16]"
               toolTip="Clocks the ARM Cortex-M4 core and bus masters [SIM_CLKDIV1_OUTDIV1]\n
                        Divides MCGOUT Clock to generate system_core_clock"
               value="1" offset="-1" min="1" max="16" />
         
            <intOption key="sim_clkdiv1_outdiv2[%(n)]"  condition="sim_clkdiv1_outdiv2_present"
               constant="true"
               description="Bus Clock Divider (OUTDIV2) - Divide by [1-16]"
               toolTip="Clocks the bus slaves and peripheral [SIM_CLKDIV1_OUTDIV2]\n
                  Divides MCGOUT Clock to generate system_bus_clock\n
                  MCGOUTCLK clock is source. Default /2"
               value="1" offset="-1" min="1" max="16" />
      
            <intOption key="sim_clkdiv1_outdiv3[%(n)]" condition="sim_clkdiv1_outdiv3_present"
               constant="true"
               description="Flexbus Clock Divider (OUTDIV3) - Divide by [1-16]"
               toolTip="Clocks the flexbus interface [SIM_CLKDIV1_OUTDIV3]\n
                        Divides MCGOUT Clock to generate system_flexbus_clock\n
                        MCGOUTCLK clock is source. Default /2"
               value="1" offset="-1" min="1" max="16" />
         
            <intOption key="sim_clkdiv1_outdiv4[%(n)]"  condition="sim_clkdiv1_outdiv4_present"
               constant="true"
               description="Flash Clock Divider (OUTDIV4) - Divide by [1-16]"
               toolTip="Clocks the flash memory [SIM_CLKDIV1_OUTDIV4]\n
                        Divides MCGOUT Clock to generate system_flash_clock\n
                        MCGOUTCLK clock is source. Default /4"
               value="4" offset="-1" min="1" max="16" />
         </category>
      </aliasCategoryOption>
   </for>
   
   <template><![CDATA[
      \t/**
      \t * Update system clock values
      \t *
      \t * @param systemClock Frequency of clock provided to system clock dividers
      \t */
      \tstatic void updateSystemClocks(unsigned systemClock) {
      \t
      \t   SystemCoreClock    = systemClock/(((SIM->CLKDIV1&SIM_CLKDIV1_OUTDIV1_MASK)>>SIM_CLKDIV1_OUTDIV1_SHIFT)+1);
      \t   SystemBusClock     = systemClock/(((SIM->CLKDIV1&SIM_CLKDIV1_OUTDIV2_MASK)>>SIM_CLKDIV1_OUTDIV2_SHIFT)+1);
      \t#ifdef SIM_CLKDIV1_OUTDIV3_MASK
      \t   SystemFlexbusClock = systemClock/(((SIM->CLKDIV1&SIM_CLKDIV1_OUTDIV3_MASK)>>SIM_CLKDIV1_OUTDIV3_SHIFT)+1);
      \t#endif
      \t#ifdef SIM_CLKDIV1_OUTDIV4_MASK
      \t//   SystemFlashClock = systemClock/(((SIM->CLKDIV1&SIM_CLKDIV1_OUTDIV4_MASK)>>SIM_CLKDIV1_OUTDIV4_SHIFT)+1);
      \t#endif
      \t}\n\n
   ]]></template>

   <xi:include href="_sim_commonTemplates.xml" />

   <validate
      class="net.sourceforge.usbdm.deviceEditor.validators.SimValidate" dim="/SIM/numberOfClockSettings">
      <param type="long" value="120MHz" />     <!-- RUN Core          -->
      <param type="long" value="60MHz"  />     <!-- RUN Bus           -->
      <param type="long" value="50MHz"  />     <!-- FlexBus           -->
      <param type="long" value="25MHz"  />     <!-- RUN Flash         -->

      <param type="long" value="4MHz"   />     <!-- VLPR Core         -->
      <param type="long" value="4MHz"   />     <!-- VLPR Bus          -->
      <param type="long" value="4MHz"   />     <!-- VLPR FlexBus      -->
      <param type="long" value="800kHz" />     <!-- VLPR Flash        -->
   </validate>
   
   <xi:include href="_simFiles-MK.xml"/>
   
</peripheralPage>
