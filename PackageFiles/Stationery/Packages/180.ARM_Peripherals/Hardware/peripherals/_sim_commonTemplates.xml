<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE fragment SYSTEM "_menu.dtd" >
<!-- _sim_commonTemplates.xml -->

<fragment xmlns:xi="http://www.w3.org/2001/XInclude">

   <template><![CDATA[
      \t/*
      \t * Template:sim_commonTemplates.xml
      \t */ \n
   ]]></template>

   <choiceOption key="/PCR/nvic_irqLevel"
      templateKey="/PCR/nvicPriority"
      enumStem="NvicPriority"
      enumType="int8_t"
      valueFormat="%s"
      description="IRQ priority levels"
      toolTip="Priority level used to configure the NVIC\n
               Subset of available levels">
      <choice name="Not Installed"  value="(int8_t)255"                  enum="NotInstalled" />
      <choice name="VeryLow"        value="(1&lt;&lt;__NVIC_PRIO_BITS)-1" enum="VeryLow"      />
      <choice name="Low"            value="(NvicPriority_VeryLow*5/6)"    enum="Low"          />
      <choice name="Midlow"         value="(NvicPriority_VeryLow*4/6)"    enum="Midlow"       />
      <choice name="Normal"         value="(NvicPriority_VeryLow*3/6)"    enum="Normal"       isDefault="true"/>
      <choice name="MidHigh"        value="(NvicPriority_VeryLow*2/6)"    enum="MidHigh"      />
      <choice name="High"           value="(NvicPriority_VeryLow*1/6)"    enum="High"         />
      <choice name="VeryHigh"       value="0"                             enum="VeryHigh"     />
   </choiceOption>

   <category name="SOPT8" description="FTM signals">
      <for keys="ch" values="0;1;2;3;4;5;6;7">
         <binaryOption key="sim_sopt8_ftm0och%(ch)src" condition="sim_sopt8_ftm0och%(ch)src_present"
            enumStem="SimFtm0Ch%(ch)OutputSrc"
            description="FTM0 channel %(ch) output source"
            toolTip="Allows modulation of FTM output">
            <choice value="0" name="FTM0 ch %(ch) direct"                 enum="Direct"             isDefault="true" />
            <choice value="1" name="FTM0 ch %(ch) modulated by FTM1 ch 1" enum="ModulatedByFtm1Ch1" />
         </binaryOption>
      </for>

      <for keys="ch" values="0;1;2;3;4;5;6;7">
         <binaryOption key="sim_sopt8_ftm3och%(ch)src"  condition="sim_sopt8_ftm3och%(ch)src_present"
            enumStem="SimFtm3Ch%(ch)OutputSrc"
            description="FTM3 channel %(ch) output source"
            toolTip="Allows modulation of FTM output">
            <choice value="0" name="FTM3 ch %(ch) direct"                 enum="Direct"             isDefault="true" />
            <choice value="1" name="FTM3 ch %(ch) modulated by FTM2 ch 1" enum="ModulatedByFtm2Ch1" />
         </binaryOption>
      </for>

      <choiceOption key="sim_sopt8_ftm_syncbits"  condition="sim_sopt8_ftm0syncbit_present"
         enumStem="SimFtmSync"
         valueFormat="%s"
         hidden="true"
         description="FTM Hardware Trigger 0 Software Asserts"
         toolTip="This allows software to assert the hardware trigger (TRIG0) FTM inputs\n
                  Use setFtmSyncBits() to assert TRIG0 input on multiple FTMs\n
                  Use clearFtmSyncBits() or clearAllFtmSyncBits() to allow other trigger sources to assert">
         <choice value="SIM_SOPT8_FTM0SYNCBIT_MASK" name="FTM0 trigger mask" enum="Ftm0" />
         <choice value="SIM_SOPT8_FTM1SYNCBIT_MASK" name="FTM1 trigger mask" enum="Ftm1" />
         <choice value="SIM_SOPT8_FTM2SYNCBIT_MASK" name="FTM2 trigger mask" enum="Ftm2" />
         <choice value="SIM_SOPT8_FTM3SYNCBIT_MASK" name="FTM3 trigger mask" enum="Ftm3" />
      </choiceOption>
   </category>

   <category name="SOPT9" description="TPM signals">

      <for keys="p" values="0;1;2;3">
         <binaryOption key="sim_sopt9_tpm%(p)clksel" condition="sim_sopt9_tpm%(p)clksel_present"
            enumStem="SimTpm%(p)ClkSel"
            description="TPM%(p) External Clock Pin"
            toolTip="External pin used to drive the clock to the TPM module">
            <choice value="0"  name="TPM_CLKIN0 pin" enum="TpmClkin0" isDefault="true" />
            <choice value="1"  name="TPM_CLKIN1 pin" enum="TpmClkin1" />
         </binaryOption>

         <choiceOption key="sim_sopt9_tpm%(p)ch0src" condition="sim_sopt9_tpm%(p)ch0src_present"
            enumStem="SimTpm%(p)Ch0Src"
            description="TPM%(p) channel 0 input capture source"
            toolTip="Source for TPM channel 0 input capture\n
               NOTE: When the TPM is not in input capture mode, clear this field">
            <choice value="0" name="TPM_CH0 signal"           enum="IcPin"  isDefault="true"/>
            <choice value="1" name="CMP0 output"              enum="Cmp0"     />
            <choice value="2" name="CMP1 output"              enum="Cmp1"     />
         </choiceOption>
      </for>
   </category>

   <if condition="!osc0_peripheral" >
      <!-- Oscillator peripheral used for OSC0 input to MCG = OSC0 -->
      <!-- This peripheral is tied closely to the MCG              -->
      <constant key="osc0_peripheral"  value="/OSC0" />
      <constant key="osc0_description" value="OSC0 - Main System Oscillator (OSCCLK0)" />
   </if>

   <if condition="rtc_independent" >
   <!-- *********************** rtc_independent *********************** -->

      <!-- Uses RTC EXTAL32/XTAL32 pins -->
      <intOption key="rtc_input_freq"
         hidden="true"
         units="Hz"
         description="External RTC Crystal"
         toolTip="Frequency of external crystal XTAL32/EXTAL32 (usually 32.768 kHz)"
         origin="Crystal on XTAL32/EXTAL32"
         value="32768"
         min="0" max="33000" />

      <!-- ERCCLK32K Sources -->
      <choiceOption key="sim_sopt1_osc32ksel" condition="!sim_sopt1_osc32ksel"
         enumStem="SimErc32kSel"
         target="system_erclk32k_clock"
         hidden="true"
         description="ERCLK32K clock source"
         toolTip="Clock source for External 32k Reference Clock [ERCLK32K]">
         <choice value="0" name="OSC0 in low range (OSC32KCLK)"  ref="/OSC0/osc32k_clock"          enum="Osc32kClk" code="Osc0Info::getOsc32kClock()"  />
         <choice value="2" name="RTC 32kHz clock"                ref="/RTC/osc_clock"              enum="Rtc32kClk" code="RtcInfo::getExternalClock()" />
         <choice value="3" name="LPO 1kHz clock"                 ref="/PMC/system_low_power_clock" enum="LpoClk"    code="PmcInfo::getLpoClock()"     isDefault="true"/>
      </choiceOption>

      <if condition="!sim_sopt2_rtcclkoutsel_not_present" >
         <choiceOption key="sim_sopt2_rtcclkoutsel"
            enumStem="SimRtcClkoutSel"
            target="rtc_clkout"
            hidden="true"
            description="RTC clock out source"
            toolTip="Clock output on the RTC_CLKOUT pin">
            <choice value="0"  name="RTC 1 Hz clock"                  ref="/RTC/rtc_1hz_clock"      enum="1Hz"   />
            <choice value="1"  name="RTC 32kHz clock (from RTC_OSC)"  ref="/RTC/rtcclk_gated_clock" enum="32kHz" isDefault="true" />
         </choiceOption>

         <intOption key="rtc_clkout"
            hidden="true"
            constant="true"
            derived="true"
            units="Hz"
            description="RTC clock out frequency"
            toolTip="Clock frequency on the RTC_CLKOUT pin"  />

         <clockCodeTemplate variable="sim_sopt2_rtcclkoutsel"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setRtcClockout(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </if>

   <else_if condition="rtc_shared" />
      <!-- *********************** rtc_shared *********************** -->

      <!-- Uses RTC_CLKIN pin -->
      <intOption key="rtc_clkin_clock"
         hidden="true"
         units="Hz"
         description="RTC_CLKIN pin"
         toolTip="External clock for the RTC (usually 32.768 kHz)"
         origin="RTC_CLKIN pin"
         value="0"
         min="0" max="33000" />

      <!-- ERCCLK32K Sources -->
      <choiceOption key="sim_sopt1_osc32ksel" condition="!sim_sopt1_osc32ksel"
         enumStem="SimErc32kSel"
         target="system_erclk32k_clock"
         hidden="true"
         description="ERCLK32K clock source"
         toolTip="Clock source for External 32k Reference Clock [ERCLK32K]">
         <choice value="0" name="OSC0 in low range (OSC32KCLK)"  ref="/OSC0/osc32k_clock"          enum="Osc32kClk" code="Osc0Info::getOsc32kClock()" />
         <choice value="2" name="RTC_CLKIN pin"                  ref="/SIM/rtc_clkin_clock"        enum="RtcClkin"  code="rtc_clkin_clock"            />
         <choice value="3" name="LPO 1kHz clock"                 ref="/PMC/system_low_power_clock" enum="LpoClk"    code="PmcInfo::getLpoClock()"  isDefault="true"/>
      </choiceOption>

      <if condition="!sim_sopt2_rtcclkoutsel_not_present" >
         <choiceOption key="sim_sopt2_rtcclkoutsel"
            enumStem="SimRtcClkoutSel"
            target="rtc_clkout"
            hidden="true"
            description="RTC clock out source"
            toolTip="Clock output on the RTC_CLKOUT pin">
            <choice value="0"  name="RTC 1 Hz clock"                  ref="/RTC/rtc_1hz_clock"      enum="1Hz"   />
            <choice value="1"  name="OSC32KCLK clock (from OSC0)"     ref="/OSC0/oscer_clock"       enum="32kHz" isDefault="true" />
         </choiceOption>

         <intOption key="rtc_clkout"
            hidden="true"
            constant="true"
            derived="true"
            units="Hz"
            description="RTC clock out frequency"
            toolTip="Clock frequency on the RTC_CLKOUT pin"  />

         <clockCodeTemplate variable="sim_sopt2_rtcclkoutsel"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setRtcClockout(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </if>

   <else />
      <!-- *********************** !rtc_independent && !rtc_shared = rtc_none *********************** -->

      <!-- ERCCLK32K Sources -->
      <choiceOption key="sim_sopt1_osc32ksel_Fixed" condition="!sim_sopt1_osc32ksel"
         target="system_erclk32k_clock"
         hidden="true"
         description="ERCLK32K clock source"
         toolTip="Clock source for External 32k Reference Clock [ERCLK32K]">
         <choice value="0" name="OSC0 in low range (OSC32KCLK)"  ref="/OSC0/osc32k_clock"          enum="Osc32kClk" code="Osc0Info::getOsc32kClock()"  />
      </choiceOption>

   </if>

   <intOption key="system_erclk32k_clock" condition="sim_sopt1_osc32ksel||sim_sopt1_osc32ksel_Fixed"
      hidden="true"
      constant="true"
      units="Hz"
      derived="true"
      description="Frequency of External 32k Reference Clock [ERCLK32K]"
      toolTip="External reference clock available to some peripherals (usually ~32kHz)"
      origin="Derived from OSC32KCLK, RTC or LPO"
      value="32768" />

<!-- ========== External clock sources =============================== -->
   <template variables="system_usb_clkin_clock" ><![CDATA[
   \t///  %description
   \tstatic constexpr uint32_t usbExternalClock=$(system_usb_clkin_clock);\n\n
   ]]></template>

   <template variables="system_sdhc_clockin" ><![CDATA[
   \t/// %description
   \tstatic constexpr uint32_t sdhcExternalClock=$(system_sdhc_clockin);\n\n
   ]]></template>

   <template variables="system_irc48m_clock[]" ><![CDATA[
   \t/// %description
   \tstatic constexpr uint32_t irc48mClock=$(system_irc48m_clock[]);\n\n
   ]]></template>

<!-- ========== SOPT1 =============================== -->
   <template namespace="usbdm" variables="sim_sopt1_ramsize"><![CDATA[
      \t/**
      \t * RAM size
      \t */
      \tenum SimRamSize {
      \t   SimRamSize_8KiB    = SIM_SOPT1_RAMSIZE(1),  ///< 8KiB RAM
      \t   SimRamSize_16KiB   = SIM_SOPT1_RAMSIZE(3),  ///< 16KiB RAM
      \t   SimRamSize_24KiB   = SIM_SOPT1_RAMSIZE(4),  ///< 24KiB RAM
      \t   SimRamSize_32KiB   = SIM_SOPT1_RAMSIZE(5),  ///< 32KiB RAM
      \t   SimRamSize_48KiB   = SIM_SOPT1_RAMSIZE(6),  ///< 32KiB RAM
      \t   SimRamSize_64KiB   = SIM_SOPT1_RAMSIZE(7),  ///< 64KiB RAM
      \t   SimRamSize_96KiB   = SIM_SOPT1_RAMSIZE(8),  ///< 96KiB RAM
      \t   SimRamSize_128KiB  = SIM_SOPT1_RAMSIZE(9),  ///< 128KiB RAM
      \t   SimRamSize_256KiB  = SIM_SOPT1_RAMSIZE(11), ///< 256KiB RAM
      \t   SimRamSize_512KiB  = SIM_SOPT1_RAMSIZE(12), ///< 256KiB RAM
      \t   SimRamSize_1024KiB = SIM_SOPT1_RAMSIZE(13), ///< 256KiB RAM
      \t};\n\n
   ]]></template>

   <template variables="sim_sopt1_ramsize"><![CDATA[
      \t/**
      \t * Get RAM size
      \t *
      \t * @return RAM size value
      \t */
      \tstatic SimRamSize getRamSize() {
      \t
      \t   return static_cast<SimRamSize>(sim->SOPT1&SIM_SOPT1_RAMSIZE_MASK);
      \t}\n\n
   ]]></template>

   <template variables="rtc_clkin_clock" ><![CDATA[
      \t/// Frequency of clock provided to RTC external input pin
      \tstatic constexpr uint32_t rtc_clkin_clock = $(rtc_clkin_clock);  \n\n
   ]]></template>

   <clockCodeTemplate variable="sim_sopt1_osc32ksel"
      returnFormat="%s"
   ><![CDATA[
      \t/**
      \t * Set %description
      \t *
      \t * @param %enumParam %tooltip
      \t */
      \tstatic void setErc32kClock(%enumClass %enumParam) {
      \t   %defaultFieldExpression
      \t}

      \t/**
      \t * Get %description
      \t *
      \t * @return Clock frequency in Hz
      \t */
      \tstatic uint32_t getErc32kClock() {
      \t
      \t   switch(%defaultMaskingExpression) {
      \t      default: return 0;
      %body
      \t   }
      \t}\n\n
   ]]></clockCodeTemplate>

   <template variables="rtc_none" ><![CDATA[
      \t/**
      \t * Get ERCLK32K clock frequency
      \t *
      \t * @return Clock frequency as a uint32_t in Hz
      \t */
      \tstatic uint32_t getErc32kClock() {
      \t   // No RTC
      \t   return Osc0Info::getOsc32kClock();  // OSC0 in 32kHz mode
      \t}\n\n
   ]]></template>

   <clockCodeTemplate variable="sim_sopt1_osc32kout"
   ><![CDATA[
      \t/**
      \t * Set %description
      \t *
      \t * @param %enumParam %tooltip
      \t */
      \tstatic void setErc32kClkoutPin(%enumClass %enumParam) {
      \t   %defaultFieldExpression
      \t}\n\n
   ]]></clockCodeTemplate>

   <clockCodeTemplate variable="sim_sopt1_usbpower"
   ><![CDATA[
      \t/**
      \t * Set %description
      \t *
      \t * @param %enumParam %tooltip
      \t */
      \tstatic void setUsbPowerModes(%enumClass %enumParam) {
      \t   sim->SOPT1CFG = SIM_SOPT1CFG_USSWE_MASK|SIM_SOPT1CFG_UVSWE_MASK|SIM_SOPT1CFG_URWE_MASK;
      \t   %defaultFieldExpression
      \t}\n\n
   ]]></clockCodeTemplate>

<!-- ========== SOPT2 =============================== -->

<!-- SOPT2 general settings -->

   <for keys="  var                     : name"
        values="sim_sopt2_fbsl          : FlexbusSecurity;
                sim_sopt2_clkoutsel     : Clkout;
                sim_sopt2_traceclksel   : TraceClockout;
                sim_sopt2_usbregen      : UsbPhyRegulator;
                sim_sopt2_ptd7pad       : PortDPad;
                sim_sopt2_rmiisrc       : Rmiiclock
        ">
      <clockCodeTemplate variable="%(var)"
      ><![CDATA[
         \t/**
         \t * Set %description
         \t *
         \t * @param %enumParam %tooltip
         \t */
         \tstatic void set%(name)(%enumClass %enumParam) {
         \t   %defaultFieldExpression
         \t}
         \t
         \t/**
         \t * Get %description
         \t *
         \t * @return %tooltip
         \t */
         \tstatic uint32_t get%(name)() {
         \t
         \t   return %defaultMaskingExpression;
         \t}\n\n
      ]]></clockCodeTemplate>
   </for>

<!-- SOPT2 clock settings -->

   <for keys="  var                     : name"
        values="sim_sopt2_pllfllsel     : PeripheralClock;
                sim_sopt2_sdhcsrc       : SdhcClock;
                sim_sopt2_tpmsrc        : TpmClock;
                sim_sopt2_flexiosrc     : FlexioClock;
                sim_sopt2_emvsimsrc     : EmvsimClock;
                sim_sopt2_timesrc       : TimestampClock;
                sim_sopt2_usbslsrc      : UsbSlowClock
                ">
      <clockCodeTemplate variable="%(var)"
      returnFormat="%s"
      ><![CDATA[
         \t/**
         \t * Set %description
         \t *
         \t * @param %enumParam %tooltip
         \t */
         \tstatic void set%(name)(%enumClass %enumParam) {
         \t   %defaultFieldExpression
         \t}

         \t/**
         \t * Get %description
         \t *  %tooltip
         \t *
         \t * @return Clock frequency in Hz
         \t */
         \tstatic uint32_t get%(name)() {
         \t
         \t   switch(%defaultMaskingExpression) {
         \t      default: return 0;
         %body
         \t   }
         \t}\n\n
      ]]></clockCodeTemplate>
   </for>

   <for keys="n" values=";0;1;2;3;4">
      <clockCodeTemplate variable="sim_sopt2_lpuart%(n)src"
         returnFormat="%s"
      ><![CDATA[
         \t/**
         \t * Set %description
         \t *
         \t * @param %enumParam %tooltip
         \t */
         \tstatic void setLpuart%(n)Clock(%enumClass %enumParam) {
         \t   %defaultFieldExpression
         \t}

         \t/**
         \t * Get %description
         \t *
         \t * @return Clock frequency in Hz
         \t */
         \tstatic uint32_t getLpuart%(n)Clock() {
         \t
         \t   switch(%defaultMaskingExpression) {
         \t      default: return 0;
         %body
         \t   }
         \t}\n\n
      ]]></clockCodeTemplate>
   </for>

   <for keys="n" values=";0;1;2;3">
      <clockCodeTemplate variable="sim_sopt2_uart%(n)src"
         returnFormat="%s"
      ><![CDATA[
         \t/**
         \t * Set %description
         \t *
         \t * @param %enumParam %tooltip
         \t */
         \tstatic void setUart%(n)Clock(%enumClass %enumParam) {
         \t   %defaultFieldExpression
         \t}

         \t/**
         \t * Get %description
         \t *
         \t * @return Clock frequency in Hz
         \t */
         \tstatic uint32_t getUart%(n)Clock() {
         \t
         \t   switch(%defaultMaskingExpression) {
         \t      default:
         %body
         \t   }
         \t}\n\n
      ]]></clockCodeTemplate>
   </for>

   <for keys="n" values=";0;1;2;3;4;5;6">
      <template variables="system_uart%(n)_fixedclocksource" ><![CDATA[
         \t/**
         \t * Get UART%(n) input clock frequency
         \t *
         \t * @return Clock frequency in Hz
         \t */
         \tstatic inline uint32_t getUart%(n)Clock() {
         \t   return $(system_uart%(n)_fixedclocksource.code[]);
         \t}\n\n
      ]]></template>
   </for>

<!-- ========== SOPT2 ClockInit class =============================== -->
   <initialValueTemplate
      variables="
         sim_sopt2_pllfllsel[],
         sim_sopt2_usbsrc[],

         sim_sopt2_clkoutsel,
         sim_sopt2_rtcclkoutsel,
         sim_sopt2_traceclksel,
         sim_sopt2_usbregen,
         sim_sopt2_ptd7pad"
   ><![CDATA[
      \t/**
      \t * Class used to do initialisation of SIM Clock control (SOPT2)
      \t *
      \t * This class has a templated constructor that accepts various values:
      \t *
      \t * @note This constructor may be used to create a const instance in ROM
      \t *
      \t * Generic Example: (see Sim::DefaultSopt2Values for device specific example)
      \t * @code
      \t * static const ClockInit clockInit {
      \t *    SimUsbFullSpeedClockSource_McgPClk, // USB Clock - Peripheral clock (MCGPCLK)
      \t *    SimTpmClockSource_McgPClk,          // TPM Clock source - MCGPCLK (HIRC=IRC48M) Clock
      \t *    SimFlexioClockSource_McgPClk,       // FLEXIO Clock select - MCGPCLK (HIRC=IRC48M) Clock
      \t *    SimClkoutSel_LpoClk,                // CLKOUT pin clock - LPO clock (1 kHz)
      \t *    SimRtcClkoutSel_32kHz,              // RTC clock out source - OSC32KCLK clock (from OSC0)
      \t *    SimLpuart0ClockSource_McgPClk,      // LPUART0 Clock - MCGPCLK (HIRC=IRC48M) Clock
      \t *    SimLpuart1ClockSource_McgPClk,      // LPUART1 Clock - MCGPCLK (HIRC=IRC48M) Clock
      \t *
      \t *    // Base value modified by above
      \t *    Sim::DefaultSopt2Values[McgClockMode_HIRC_48MHz]
      \t * };
      \t *
      \t * // Initialise SIM Clock control from values specified above
      \t * clockInit.configure()
      \t * @endcode
      \t */
      \tclass ClockInit {
      \t
      \tpublic:
      \t
      \t   /// System Options Register 2
      \t   uint32_t sopt2 = 0;
      \t
      \t   /**
      \t    * Copy Constructor
      \t    */
      \t   constexpr ClockInit(const ClockInit &other) = default;
      \t
      \t   /**
      \t    * Default Constructor
      \t    */
      \t   constexpr ClockInit() = default;
      \t
      \t   /**
      \t    * Configure SIM Clock control from values specified in constructor.
      \t    */
      \t   void configure() const {\n
      \t      %register = %registerName;
      \t   }\n\n
   ]]></initialValueTemplate>
   <for keys="v"
      values="
         sim_sopt2_pllfllsel[];
         sim_sopt2_usbsrc[];

         sim_sopt2_sdhcsrc[];
         sim_sopt2_tpmsrc[];
         sim_sopt2_flexiosrc[];
         sim_sopt2_emvsimsrc[];
         sim_sopt2_timesrc[];

         sim_sopt2_rmiisrc;
         sim_sopt2_usbslsrc;
         sim_sopt2_fbsl;
         sim_sopt2_clkoutsel;
         sim_sopt2_rtcclkoutsel;
         sim_sopt2_traceclksel;
         sim_sopt2_usbregen;
         sim_sopt2_ptd7pad
         ">
      <setTemplate variables="%(v)"
            linePadding="xxx"
      ><![CDATA[
         \t   /**
         \t    * Constructor for %description
         \t    *
         \t    * @tparam   Types
         \t    * @param    rest
         \t    *
         %paramDescription
         \t    */
         \t   template <typename... Types>
         \t   constexpr ClockInit(%params, Types... rest) : ClockInit(rest...) {
         \t
         \t      %registerName |= %paramExpression;
         \t   }
         \t\n
      ]]></setTemplate>
   </for>
   <for keys="m" values="'';0;1;2;3;4">
      <for keys="v"
         values="
             sim_sopt2_lpuart%(m)src[];
             sim_sopt2_uart%(m)src[]">
         <setTemplate variables="%(v)"
            linePadding="xxx"
         ><![CDATA[
            \t   /**
            \t    * Constructor for %description
            \t    *
            \t    * @tparam   Types
            \t    * @param    rest
            \t    *
            %paramDescription
            \t    */
            \t   template <typename... Types>
            \t   constexpr ClockInit(%params, Types... rest) : ClockInit(rest...) {
            \t
            \t      %registerName |= %paramExpression;
            \t   }
            \t\n
         ]]></setTemplate>
      </for>
   </for>
   <template ><![CDATA[
      \t};\n\n
   ]]></template>

   <template key="DefaultInitValue" namespace="all" ><![CDATA[
      \t/**
      \t * Default value for Sim::ClockInit
      \t * This value is created from Configure.usbdmProject settings
      \t */
      \tstatic constexpr ClockInit DefaultSopt2Values[] = {\n
   ]]></template>
   <for keys="n" dim="/SIM/numberOfClockSettings" >
      <template key="DefaultInitValue" namespace="all" codeGenCondition="/MCG/enableClockConfiguration[%(n)]"
      ><![CDATA[
         \t{ // $(/MCG/ClockConfig[%(n)]) ($(/MCG/mcgClockMode[%(n)].enum[]))\n
      ]]></template>
      <setTemplate key="DefaultInitValue" namespace="all" codeGenCondition="/MCG/enableClockConfiguration[%(n)]"
         variables="
            sim_sopt2_pllfllsel[%(n)],
            sim_sopt2_usbsrc[%(n)],

            sim_sopt2_sdhcsrc[%(n)],
            sim_sopt2_tpmsrc[%(n)],
            sim_sopt2_flexiosrc[%(n)],
            sim_sopt2_emvsimsrc[%(n)],
            sim_sopt2_timesrc[%(n)],

            sim_sopt2_rmiisrc,
            sim_sopt2_usbslsrc,
            sim_sopt2_fbsl,
            sim_sopt2_clkoutsel,
            sim_sopt2_rtcclkoutsel,
            sim_sopt2_traceclksel,
            sim_sopt2_usbregen,
            sim_sopt2_ptd7pad"
         terminator=","
         separator=","
      ><![CDATA[
         %initExpression\n
      ]]></setTemplate>
      <for keys="m" values="'';0;1;2;3;4">
         <for keys="v"
            values="
                sim_sopt2_lpuart%(m)src[%(n)];
                sim_sopt2_uart%(m)src[%(n)]"
                >
            <setTemplate key="DefaultInitValue" namespace="all"  codeGenCondition="/MCG/enableClockConfiguration[%(n)]"
               terminator=","
               separator=","
               variables="%(v)"
               ><![CDATA[
               %initExpression\n
            ]]></setTemplate>
         </for>
      </for>
      <template key="DefaultInitValue" namespace="all"  codeGenCondition="/MCG/enableClockConfiguration[%(n)]"
      ><![CDATA[
         \t},\n
      ]]></template>
   </for>
   <template key="DefaultInitValue" namespace="all" ><![CDATA[
      };\n\n
   ]]></template>

<!-- ========== SOPT4 =============================== -->
   <for keys="ftm" values="0;1;2;3">
      <for keys="flt" values="0;1;2;3">
         <clockCodeTemplate variable="sim_sopt4_ftm%(ftm)flt%(flt)"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setFtm%(ftm)Flt%(flt)(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

   <for keys="ftm" values="0;1;2;3">
      <for keys="ch" values="0;1;2;3">
         <clockCodeTemplate variable="sim_sopt4_ftm%(ftm)ch%(ch)src"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setFtm%(ftm)Ch%(ch)Src(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

   <for keys="ftm" values="0;1;2;3">
      <clockCodeTemplate variable="sim_sopt4_ftm%(ftm)clksel"
      ><![CDATA[
         \t/**
         \t * Set %description
         \t *
         \t * @param %enumParam %tooltip
         \t */
         \tstatic void setFtm%(ftm)ClkSel(%enumClass %enumParam) {
         \t   %defaultFieldExpression
         \t}\n\n
      ]]></clockCodeTemplate>
   </for>

   <for keys="ftm" values="0;1;2;3">
      <for keys="trg" values="0;1;2;3">
         <clockCodeTemplate variable="sim_sopt4_ftm%(ftm)trg%(trg)src"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setFtm%(ftm)Trg%(trg)Src(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

   <for keys="tpm" values="0;1;2;3">
      <clockCodeTemplate variable="sim_sopt4_tpm%(tpm)clksel"
      ><![CDATA[
         \t/**
         \t * Set %description
         \t *
         \t * @param %enumParam %tooltip
         \t *
         \t * @note The selected pin must also be configured for the TPM external clock function
         \t * through the appropriate pin control register in the port control module
         \t */
         \tstatic void setTpm%(tpm)ExternalClockInput(%enumClass %enumParam) {
         \t   %defaultFieldExpression
         \t}\n\n
      ]]></clockCodeTemplate>
   </for>

    <for keys="tpm" values="0;1;2;3">
      <for keys="ch" values="0;1;2;3">
         <clockCodeTemplate variable="sim_sopt4_tpm%(tpm)ch%(ch)src"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t *
            \t * @note The selected pin must also be configured for the TPM external clock function
            \t * through the appropriate pin control register in the port control module
            \t */
            \tstatic void setTpm%(tpm)Ch%(ch)InputCaptureSource(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

<!-- ========== SOPT5 =============================== -->

   <for keys="n" values="0;1;2;3;4;5">
      <for keys   = "name       : Name"
           values = "uart%(n)   : Uart%(n);
                     lpuart%(n) : Lpuart%(n)" >

         <setTemplate
            variables="sim_sopt5_%(name)ode,sim_sopt5_%(name)txsrc,sim_sopt5_%(name)rxsrc"
            linePadding="xxx"
         ><![CDATA[
            \t/**
            \t * Class used to do initialisation of %(Name) signals
            \t *
            \t * @note This constructor may be used to create a const instance in ROM
            \t *
            \t * Example:
            \t * @code
            \t * static const %(Name)Init %(name)Init {
            \t * };
            \t *
            \t * // Initialise %(Name) signals from values specified above
            \t * %(name)Init.configure()
            \t * @endcode
            \t */
            \tclass %(Name)Init {
            \t
            \tpublic:
            \t   /// %(Name) signals
            \t   uint32_t %registerName = 0;
            \t
            \t   /**
            \t    * Copy Constructor
            \t    */
            \t   constexpr %(Name)Init(const %(Name)Init &other) = default;
            \t
            \t   /**
            \t    * Default Constructor
            \t    */
            \t   constexpr %(Name)Init() = default;
            \t
            \t   /**
            \t    * Constructor
            %paramDescription
            \t    */
            \t   constexpr %(Name)Init(
            %params) {
            \t
            \t      %registerName = (%registerName & ~%mask) |
            \t                       %paramExpression;
            \t   }
            \t   /**
            \t    * Configure %(Name) signals from values specified in constructor.
            \t    */
            \t   void configure() const {\n
            \t      %register = (%register&~%mask) | %registerName;
            \t   }\n
         ]]></setTemplate>
         <for keys="v" values="sim_sopt5_%(name)ode;sim_sopt5_%(name)txsrc;sim_sopt5_%(name)rxsrc">
            <setTemplate
               variables="%(v)"
               linePadding="xxx"
            ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @tparam   Types
            \t * @param    rest
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \t   template <typename... Types>
            \t   constexpr %(Name)Init(%enumClass %enumParam, Types... rest) : Init(rest...) {
            \t      %registerName = (%registerName & ~%mask) | %paramExpression;
            \t}\n\n
            ]]></setTemplate>
         </for>
         <setTemplate
            variables="sim_sopt5_%(name)ode,sim_sopt5_%(name)txsrc,sim_sopt5_%(name)rxsrc"
            linePadding="xxx"
         ><![CDATA[
            \t};\n\n
         ]]></setTemplate>

         <setTemplate variables="sim_sopt5_%(name)ode,sim_sopt5_%(name)txsrc,sim_sopt5_%(name)rxsrc"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            %paramDescription
            \t */
            \tstatic void configure%(Name)(
            %params) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></setTemplate>

         <clockCodeTemplate variable="sim_sopt5_%(name)ode"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void set%(Name)Drive(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>

         <clockCodeTemplate variable="sim_sopt5_%(name)rxsrc"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void set%(Name)RxSrc(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>

         <clockCodeTemplate variable="sim_sopt5_%(name)txsrc"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void set%(Name)TxSrc(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

<!-- ========== SOPT7 =============================== -->
   <setTemplate
      variables="
         sim_sopt7_adc0trigger,sim_sopt7_adc0trgsel,
         sim_sopt7_adc1trigger,sim_sopt7_adc1trgsel"
      linePadding="xxx"
   ><![CDATA[
      \t/**
      \t * Class used to do initialisation of Adc trigger sources
      \t *
      \t * @note This constructor may be used to create a const instance in ROM
      \t *
      \t * Example:
      \t * @code
      \t * static const AdcInit adcInit {
      \t * };
      \t *
      \t * // Initialise Adc signals from values specified above
      \t * adcInit.configure()
      \t * @endcode
      \t */
      \tclass AdcInit {
      \t
      \tpublic:
      \t   /// Adc signals
      \t   uint32_t %registerName = 0;
      \t
      \t   /**
      \t    * Copy Constructor
      \t    */
      \t   constexpr AdcInit(const AdcInit &other) = default;
      \t
      \t   /**
      \t    * Default Constructor
      \t    */
      \t   constexpr AdcInit() = default;
      \t\n
   ]]></setTemplate>

   <for keys="p" values=";0;1">
      <setTemplate
         variables="sim_sopt7_adc%(p)trigger"
         linePadding="xxx"
      ><![CDATA[
         \t   /**
         \t    * Constructor for %description
         \t    *
         \t    * @tparam   Types
         \t    * @param    rest
         \t    *
         %paramDescription
         \t    */
         \t   template <typename... Types>
         \t   constexpr AdcInit(%params, Types... rest) : AdcInit(rest...) {
         \t
         \t      %registerName = (%registerName & ~%mask) | %paramExpression;
         \t   }
         \t\n
      ]]></setTemplate>
      <setTemplate
         variables="sim_sopt7_adc%(p)trigger,sim_sopt7_adc%(p)trgsel"
         linePadding="xxx"
         nonDefaultParams="2"
      ><![CDATA[
         \t   /**
         \t    * Constructor for %description0 and %description1
         \t    *
         \t    * @tparam   Types
         \t    * @param    rest
         \t    *
         %paramDescription
         \t    */
         \t   template <typename... Types>
         \t   constexpr AdcInit(
         %params, Types... rest) : AdcInit(rest...) {
         \t
         \t      %registerName = (%registerName & ~%mask) | %paramExpression;
         \t   }
         \t\n
      ]]></setTemplate>
   </for>

   <setTemplate
      variables="
         sim_sopt7_adc0trigger,sim_sopt7_adc0trgsel,
         sim_sopt7_adc1trigger,sim_sopt7_adc1trgsel"
      linePadding="xxx"
   ><![CDATA[
      \t   /**
      \t    * Configure ADC trigger sources from values specified in constructor.
      \t    */
      \t   void configure() const {\n
      \t      %register = (%register&~%mask) |
      \t                   %registerName;
      \t   }
      \t};\n\n
   ]]></setTemplate>

   <for keys="p" values=";0;1">
      <setTemplate
         variables="sim_sopt7_adc%(p)trigger,sim_sopt7_adc%(p)trgsel"
            linePadding="xxx"
      ><![CDATA[
         \t/**
         \t * Class used to do initialisation of Adc%(p) trigger sources
         \t *
         \t * @note This constructor may be used to create a const instance in ROM
         \t *
         \t * Example:
         \t * @code
         \t * static const Adc%(p)Init adc%(p)Init {
         \t * };
         \t *
         \t * // Initialise Adc signals from values specified above
         \t * adc%(p)Init.configure()
         \t * @endcode
         \t */
         \tclass Adc%(p)Init {
         \t
         \tpublic:
         \t   /// Adc signals
         \t   uint32_t %registerName = 0;
         \t
         \t   /**
         \t    * Copy Constructor
         \t    */
         \t   constexpr Adc%(p)Init(const Adc%(p)Init &other) = default;
         \t
         \t   /**
         \t    * Default Constructor
         \t    */
         \t   constexpr Adc%(p)Init() = default;
         \t
         \t   /**
         \t    * Constructor
         %paramDescription
         \t    */
         \t   constexpr Adc%(p)Init(
         %params) {
         \t
         \t      %registerName = %paramExpression;
         \t   }
         \t   /**
         \t    * Configure Adc signals from values specified in constructor.
         \t    */
         \t   void configure() const {\n
         \t      %register = (%register&~%mask) | %registerName;
         \t   }
         \t};\n\n
      ]]></setTemplate>

      <setTemplate variables="sim_sopt7_adc%(p)trigger,sim_sopt7_adc%(p)trgsel" ><![CDATA[
         \t/**
         \t * Set %description0 and %description2
         \t *
         %paramDescription
         \t *
         \t * For example, setAdc%(p)Triggers(SimAdc%(p)TriggerMode_Alt_PreTrigger_1, SimAdc0Trigger_PitCh0) will set the trigger source
         \t * to PIT channel 0 and conversion will use SC1[1]/R[1]
         \t */
         \tstatic void setAdc%(p)Triggers(
         %params) {
         \t
         \t   %register = (%register&~%mask)|(%paramExpression);
         \t};\n\n
      ]]></setTemplate>
   </for>

<!-- ========== SOPT8 =============================== -->

   <for keys="p" values="0;1;2;3">
      <for keys="ch" values="0;1;2;3;4;5;6;7">
         <clockCodeTemplate variable="sim_sopt8_ftm%(p)och%(ch)src"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setFtm%(p)Ch%(ch)OutputSrc(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

   <clockCodeTemplate variable="sim_sopt8_ftm_syncbits"
   ><![CDATA[
      \t/**
      \t * Set %description
      \t *
      \t * %tooltip
      \t *
      \t * @param %enumParam Mask of bits made up from %enumClass values
      \t */
      \tstatic void setFtmSyncBits(uint32_t %enumParam) {
      \t   sim->SOPT8 = sim->SOPT8 | %enumParam;
      \t}

      \t/**
      \t * Clear %description
      \t *
      \t * %tooltip
      \t *
      \t * @param %enumParam Mask of bits made up from %enumClass values
      \t */
      \tstatic void clearFtmSyncBits(uint32_t %enumParam) {
      \t   sim->SOPT8 = sim->SOPT8 & ~%enumParam;
      \t}

      \t/**
      \t * Clear all %description
      \t *
      \t * %tooltip
      \t */
      \tstatic void clearAllFtmSyncBits() {
      \t   sim->SOPT8 = sim->SOPT8 &
      \t      ~(SIM_SOPT8_FTM0SYNCBIT_MASK|SIM_SOPT8_FTM1SYNCBIT_MASK|SIM_SOPT8_FTM2SYNCBIT_MASK|SIM_SOPT8_FTM3SYNCBIT_MASK);
      \t}\n\n
   ]]></clockCodeTemplate>

<!-- ========== SOPT9 =============================== -->

   <for keys="p" values="1;2">
      <for keys="Fn:FN:fn" values="ClkSel:CLKSEL:clksel;Ch0Src:CH0SRC:ch0src">
         <clockCodeTemplate variable="sim_sopt9_tpm%(p)%(fn)"
         ><![CDATA[
            \t/**
            \t * Set %description
            \t *
            \t * @param %enumParam %tooltip
            \t */
            \tstatic void setTpm%(p)%(Fn)(%enumClass %enumParam) {
            \t   %defaultFieldExpression
            \t}\n\n
         ]]></clockCodeTemplate>
      </for>
   </for>

<!-- ========== CLKDIV2 =============================== -->
   <clockCodeTemplate variable="sim_sopt2_usbsrc"
   ><![CDATA[
      \t/**
      \t * Set %description
      \t *
      \t * If the internal clock is selected then the clock divider will be recalculated
      \t *
      \t * @param %enumParam %tooltip
      \t */
      \tstatic ErrorCode setUsbFullSpeedClock(%enumClass %enumParam) {
      \t   ErrorCode rc = E_NO_ERROR;
      \t
      \t   // The USB interface must be disabled for clock changes to have effect
      \t   sim->SCGC4 = sim->SCGC4 & ~SIM_SCGC4_USBOTG_MASK;
      \t
      \t   // Set clock source
      \t   %defaultFieldExpression
      \t\n
   ]]></clockCodeTemplate>
   <template variables="sim_clkdiv2_usb[]" ><![CDATA[
      \t   if (simUsbFullSpeedClockSource == SimUsbFullSpeedClockSource_PeripheralClk) {
      \t      // Set clock divider for internal clock
      \t      rc = E_CLOCK_INIT_FAILED;
      \t      // Try to calculate value
      \t      unsigned inputFreq = getPeripheralClock();
      \t      for (unsigned frac = 0; frac < 2; frac++) {
      \t         for (unsigned div = 0; div < 8; div++) {
      \t            unsigned usbClock = (inputFreq * (frac+1))/(div+1);
      \t            if (usbClock == 48000000) {
      \t               // Found suitable value
      \t               sim->CLKDIV2 = SIM_CLKDIV2_USBFRAC(frac)|SIM_CLKDIV2_USBDIV(div);
      \t               rc = E_NO_ERROR;
      \t            }
      \t         }
      \t      }
      \t   }
      \t   rc = setErrorCode(rc);\n\n
   ]]></template>
   <template variables="sim_sopt2_usbsrc" ><![CDATA[
      \t   // Restore USB clock
      \t   sim->SCGC4 = sim->SCGC4 | SIM_SCGC4_USBOTG_MASK;
      \t   return rc;
      \t}

      \t/**
      \t * Get USB clock frequency
      \t *
      \t * @return Clock frequency as a uint32_t in Hz
      \t */
      \tstatic uint32_t getUsbFullSpeedClock() {
      \t   switch ((sim->SOPT2&SIM_SOPT2_USBSRC_MASK)) {
      \t      default:
      \t      case $(sim_sopt2_usbsrc[].enum[0]) : return usbExternalClock;\n
   ]]></template>
   <template variables="sim_clkdiv2_usb[]" ><![CDATA[
      \t      case $(sim_sopt2_usbsrc[].enum[1]) :
      \t         return  (getPeripheralClock()*
      \t            (((sim->CLKDIV2&SIM_CLKDIV2_USBFRAC_MASK)>>SIM_CLKDIV2_USBFRAC_SHIFT)+1))/
      \t            (((sim->CLKDIV2&SIM_CLKDIV2_USBDIV_MASK)>>SIM_CLKDIV2_USBDIV_SHIFT)+1);\n
   ]]></template>
   <template condition="!sim_clkdiv2_usb[]&amp;&amp;sim_sopt2_usbsrc" ><![CDATA[
      \t      case $(sim_sopt2_usbsrc[].enum[1]) : return getPeripheralClock();\n
   ]]></template>
   <template variables="sim_sopt2_usbsrc" ><![CDATA[
      \t   }
      \t}\n\n
   ]]></template>

   <template variables="sim_clkdiv2_usb"><![CDATA[
      \t/**
      \t * Set USB clock divisors to suitable value and enable clock
      \t */
      \tstatic void updateUsbClockDivider() {
      \t
      \t   setUsbFullSpeedClock((SimUsbFullSpeedClockSource)(sim->SOPT2&SIM_SOPT2_USBSRC_MASK));
      \t}\n\n
   ]]></template>

<!-- ========== CLKDIV3 =============================== -->
   <clockCodeTemplate variable="sim_clkdiv3_pllfll"
   ><![CDATA[
      \t/**
      \t * Set %description
      \t *
      \t * @param %enumParam %tooltip
      \t */
      \tstatic void setPeripheralClockDivider(%enumClass %enumParam) {
      \t   // Must disable clock to TPMs, LPUARTs and FLEXIO before changing clock divider
      \t   uint32_t scgc2 = sim->SCGC2;
      \t   sim->SCGC2   = 0;
      \t   sim->CLKDIV3 = simPeripheralClockDivider;
      \t   sim->SCGC2   = scgc2;
      \t}

      \t/**
      \t * Get %description
      \t *
      \t * @return Clock frequency in Hz
      \t */
      \tstatic uint32_t getDividedPeripheralClock() {
      \t
      \t   int  pllfllfrac  = (sim->CLKDIV3&SIM_CLKDIV3_PLLFLLFRAC_MASK)>>SIM_CLKDIV3_PLLFLLFRAC_SHIFT;
      \t   int  pllflldiv   = (sim->CLKDIV3&SIM_CLKDIV3_PLLFLLDIV_MASK)>>SIM_CLKDIV3_PLLFLLDIV_SHIFT;
      \t   return (getPeripheralClock()*(pllfllfrac+1))/(pllflldiv+1);
      \t}\n\n
   ]]></clockCodeTemplate>

<!-- ========== COP Watchdog =============================== -->
   <initialValueTemplate
      variables="
         sim_copc_copdbgen,
         sim_copc_copstpen,
         sim_copc_copw,
         sim_copc_copt"
   ><![CDATA[
         \t/// COP Control Register
         \tstatic constexpr uint32_t copc = %initExpression\n\n
   ]]></initialValueTemplate>

   <if condition="sim_copc_copt" >
      <template><![CDATA[
         \t/**
         \t * Feed COP watchdog
         \t */
         \tstatic void refreshCop() {
         \t   sim->SRVCOP = 0x55;
         \t   sim->SRVCOP = 0xAA;
         \t}\n\n
      ]]></template>

      <template key="/SYSTEM/Includes" namespace="all" ><![CDATA[
      ]]></template>

      <template key="/SYSTEM/WatchdogInitialise" namespace="all" variables="sim_copc_copt" ><![CDATA[
         \t/*
         \t * Initialise watchdog
         \t */
         \tUSBDM::SimInfo::sim->COPC = USBDM::SimInfo::copc;
         \t
      ]]></template>
   </if>

<!-- ========== SIM Init class =============================== -->
   <template><![CDATA[
      \t/**
      \t * Class used to do initialisation of SIM
      \t *
      \t * This class has a templated constructor that accepts various values:
      \t *
      \t * @note This constructor may be used to create a const instance in ROM
      \t * @note Actual parameters available vary with device - see Sim::DefaultInitValue for custom example
      \t *
      \t * Example:
      \t * @code
      \t * static const Sim::Init simInit {
      \t *    SimErc32kClkoutPinSelect_None,            // ERCLK32K Clock Output
      \t *    SimErc32kSel_LpoClk,                      // ERCLK32K clock source
      \t *    SimUsbPower_EnabledInAll,                 // USB voltage regulator power control
      \t *    SimUsbFullSpeedClockSource_PeripheralClk, // USB Clock
      \t *    SimTraceClockoutSel_McgOutClk,            // Debug trace clock select
      \t *    SimRtcClkoutSel_32kHz ,                   // RTC clock out source
      \t *    SimClkoutSel_OscerClk0 ,                  // CLKOUT pin clock
      \t *    SimPeripheralClockSource_Irc48mClk ,      // Peripheral Clock
      \t *    SimFlexbusSecurity_None,                  // FlexBus off-chip access security level
      \t *    SimLpuartClockSource_PeripheralClk,       // LPUART Clock select
      \t *    SimTraceClockoutSel_McgOutClk,            // Debug trace clock select
      \t *    SimRtcClkoutSel_32kHz,                    // RTC clock out source
      \t *    SimClkoutSel_OscerClk0,                   // CLKOUT pin clock
      \t *    SimPeripheralClockSource_Irc48mClk,       // Peripheral Clock
      \t *    SimFlexbusSecurity_None,                  // FlexBus off-chip access security level
      \t *    SimFtm0Flt0_Ftm0Fault0,                   // FTM0 Fault 0 Select
      \t *    SimFtm0Trg0Src_Cmp0,                      // FTM0 Hardware Trigger 0 Source
      \t *    SimFtm0Flt1_Ftm0Fault1,                   // FTM0 Fault 1 Select
      \t *    SimFtm0Trg1Src_PdbTrigger1,               // FTM0 Hardware Trigger 1 Source
      \t *    SimFtm0ClkSel_FtmClkin0,                  // FTM0 External Clock Pin
      \t *    SimFtm1Flt0_Ftm1Fault0,                   // FTM1 Fault 0 Select
      \t *    SimFtm1Ch0Src_IcPin,                      // FTM 1 channel 0 input capture source
      \t *    SimFtm1ClkSel_FtmClkin0,                  // FTM1 External Clock Pin
      \t *    SimFtm2Flt0_Ftm2Fault0,                   // FTM2 Fault 0 Select
      \t *    SimFtm2Ch0Src_IcPin,                      // FTM2 channel 0 input capture source
      \t *    SimFtm2Ch1Src_IcPin,                      // FTM2 channel 1 input capture source
      \t *    SimFtm2ClkSel_FtmClkin0,                  // FTM2 External Clock Pin
      \t *    SimFtm3Flt0_Ftm3Fault0,                   // FTM3 Fault 0 Select
      \t *    SimFtm3Trg0Src_Ftm1,                      // FTM3 Hardware Trigger 0 Source
      \t *    SimFtm3Trg1Src_Ftm2,                      // FTM3 Hardware Trigger 1 Source
      \t *    SimFtm3ClkSel_FtmClkin0,                  // FTM3 External Clock Pin
      \t *    SimUart0RxSrc_RxPin,                      // UART 0 receive data source
      \t *    SimUart0TxSrc_Direct,                     // UART 0 transmit data source
      \t *    SimLpuart0RxSrc_RxPin,                    // LPUART 0 receive data source
      \t *    SimUart1RxSrc_RxPin,                      // UART 1 receive data source
      \t *    SimUart1TxSrc_Direct,                     // UART 1 transmit data source
      \t *    SimAdc0TriggerMode_Pdb ,                  // ADC0 trigger mode
      \t *    SimAdc0TriggerSrc_External,               // ADC0 trigger
      \t *    SimAdc1TriggerMode_Pdb ,                  // ADC1 trigger mode
      \t *    SimAdc1TriggerSrc_External,               // ADC1 trigger
      \t *    SimFtm0Ch0OutputSrc_Direct,               // FTM0 channel 0 output source
      \t *    SimFtm3Ch0OutputSrc_Direct,               // FTM3 channel 0 output source
      \t *    SimFtm0Ch1OutputSrc_Direct,               // FTM0 channel 1 output source
      \t *    SimFtm3Ch1OutputSrc_Direct,               // FTM3 channel 1 output source
      \t *    SimFtm0Ch2OutputSrc_Direct,               // FTM0 channel 2 output source
      \t *    SimFtm3Ch2OutputSrc_Direct,               // FTM3 channel 2 output source
      \t *    SimFtm0Ch3OutputSrc_Direct,               // FTM0 channel 3 output source
      \t *    SimFtm3Ch3OutputSrc_Direct,               // FTM3 channel 3 output source
      \t *    SimFtm0Ch4OutputSrc_Direct,               // FTM0 channel 4 output source
      \t *    SimFtm3Ch4OutputSrc_Direct,               // FTM3 channel 4 output source
      \t *    SimFtm0Ch5OutputSrc_Direct,               // FTM0 channel 5 output source
      \t *    SimFtm3Ch5OutputSrc_Direct,               // FTM3 channel 5 output source
      \t *    SimFtm0Ch6OutputSrc_Direct,               // FTM0 channel 6 output source
      \t *    SimFtm3Ch6OutputSrc_Direct,               // FTM3 channel 6 output source
      \t *    SimFtm0Ch7OutputSrc_Direct,               // FTM0 channel 7 output source
      \t *    SimFtm3Ch7OutputSrc_Direct,               // FTM3 channel 7 output source
      \t *    SimTpm1ClkSel_TpmClkin0,                  // TPM1 External Clock Pin
      \t *    SimTpm1Ch0Src_IcPin,                      // TPM1 channel 0 input capture source
      \t *    SimTpm2ClkSel_TpmClkin0,                  // TPM2 External Clock Pin
      \t *    SimTpm2Ch0Src_IcPin,                      // TPM2 channel 0 input capture source
      \t * };
      \t *
      \t * // Initialise SIM from values specified above
      \t * simInit.configure()
      \t * @endcode
      \t */
      \tclass Init {
      \t
      \tpublic:
      \t   /**
      \t    * Copy Constructor
      \t    */
      \t   constexpr Init(const Init &other) = default;
      \t
      \t   /**
      \t    * Default Constructor
      \t    */
      \t   constexpr Init() = default;
      \t\n
   ]]></template>
   <template><![CDATA[
      \t   /**
      \t    * Configure SIM from values specified in constructor.
      \t    */
      \t   void configure() const {\n
   ]]></template>
   <template condition="sim_sopt1_usbpower" ><![CDATA[
      \t      sim->SOPT1CFG = SIM_SOPT1CFG_USSWE_MASK|SIM_SOPT1CFG_UVSWE_MASK|SIM_SOPT1CFG_URWE_MASK;\n
   ]]></template>
   <template condition="sim_sopt1_osc32kout||sim_sopt1_osc32ksel||sim_sopt1_usbpower" ><![CDATA[
      \t      sim->SOPT1 = sopt1;\n
   ]]></template>
   <template><![CDATA[
      \t      sim->SOPT2 = sopt2;   // SOPT2 may also be altered by MCG clock code
      \t      sim->SOPT4 = sopt4;
      \t      sim->SOPT5 = sopt5;
      \t      sim->SOPT7 = sopt7;\n
      ]]></template>
   <template variables="sim_sopt8_ftm0och0src" ><![CDATA[
      \t      sim->SOPT8 = sopt8;\n
   ]]></template>
   <template variables="sim_sopt9_tpm1clksel" ><![CDATA[
      \t      sim->SOPT9 = sopt9;\n
   ]]></template>
   <template variables="sim_clkdiv2_usb" ><![CDATA[
      \t
      \t      updateUsbClockDivider();\n
   ]]></template>
   <template><![CDATA[
      \t   }\n\n
   ]]></template>
   <setTemplate
      variables=
         "sim_sopt1_osc32kout,
          sim_sopt1_osc32ksel,
          sim_sopt1_usbpower"
    ><![CDATA[
      \t   /// System Options Register 1
      \t   uint32_t sopt1 = 0;\n\n
   ]]></setTemplate >
   <initialValueTemplate
      variables="
         sim_sopt2_pllfllsel[],
         sim_sopt2_ptd7pad,
         sim_sopt2_lpuartsrc,
         sim_sopt2_lpuart0src,
         sim_sopt2_lpuart1src,
         sim_sopt2_uart0src,
         sim_sopt2_tpmsrc,
         sim_sopt2_usbsrc[],
         sim_sopt2_traceclksel,
         sim_sopt2_rtcclkoutsel,
         sim_sopt2_clkoutsel,
         sim_sopt2_emvsimsrc,
         sim_sopt2_sdhcsrc,
         sim_sopt2_fbsl,
         sim_sopt2_flexiosrc,
         sim_sopt2_timesrc,
         sim_sopt2_rmiisrc"
   ><![CDATA[
      \t   /// System Options Register 2
      \t   uint32_t sopt2 = 0;\n\n
   ]]></initialValueTemplate>
   <initialValueTemplate
      variables="
         sim_sopt4_ftm0flt0,
         sim_sopt4_ftm0trg0src,
         sim_sopt4_ftm0ch0src,
         sim_sopt4_tpm0ch0src,
         sim_sopt4_tpm0clksel,
         sim_sopt4_ftm0clksel"
   ><![CDATA[
      \t   /// System Options Register 4
      \t   uint32_t sopt4 = 0;\n\n
   ]]></initialValueTemplate>
   <initialValueTemplate
      variables="
         sim_sopt5_uart0ode,
         sim_sopt5_uart0rxsrc,
         sim_sopt5_uart0txsrc,
         sim_sopt5_lpuart0ode,
         sim_sopt5_lpuart0rxsrc,
         sim_sopt5_lpuart0txsrc"
   ><![CDATA[
      \t   /// System Options Register 5
      \t   uint32_t sopt5 = 0;\n\n
   ]]></initialValueTemplate>
   <initialValueTemplate
      variables="
         sim_sopt7_adc0trigger,
         sim_sopt7_adc0trgsel"
   ><![CDATA[
      \t   /// System Options Register 7
      \t   uint32_t sopt7 = 0;\n\n
   ]]></initialValueTemplate>
   <initialValueTemplate
      variables="
         sim_sopt8_ftm0och0src,
         sim_sopt8_ftm3och0src"
   ><![CDATA[
      \t   /// System Options Register 8
      \t   uint32_t sopt8 = 0;\n\n
   ]]></initialValueTemplate>
   <initialValueTemplate
      variables="
         sim_sopt9_tpm1clksel,
         sim_sopt9_tpm2ch0src,
         sim_sopt9_tpm1clksel,
         sim_sopt9_tpm2ch0src"
   ><![CDATA[
      \t   /// System Options Register 9
      \t   uint32_t sopt9 = 0;\n\n
   ]]></initialValueTemplate>

   <template ><![CDATA[
      \t
      \tpublic:\n
   ]]></template>

   <for keys="n" values=";0;1;2;3;4">
      <for keys="v"
         values="
             sim_sopt2_lpuart%(n)src;
             sim_sopt2_uart%(n)src">
         <setTemplate variables="%(v)"
            linePadding="xxx"
         ><![CDATA[
            \t   /**
            \t    * Constructor for %description
            \t    *
            \t    * @tparam   Types
            \t    * @param    rest
            \t    *
            %paramDescription
            \t    */
            \t   template <typename... Types>
            \t   constexpr Init(%params, Types... rest) : Init(rest...) {
            \t
            \t      %registerName |= %paramExpression;
            \t   }
            \t\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="v"
      values="
         sim_sopt2_pllfllsel;
         sim_sopt1_osc32kout;
         sim_sopt1_osc32ksel;
         sim_sopt1_usbpower;
         sim_sopt2_ptd7pad;
         sim_sopt2_tpmsrc;
         sim_sopt2_usbsrc;
         sim_sopt2_traceclksel;
         sim_sopt2_rtcclkoutsel;
         sim_sopt2_clkoutsel;
         sim_sopt2_emvsimsrc;
         sim_sopt2_sdhcsrc;
         sim_sopt2_fbsl;
         sim_sopt2_flexiosrc;
         sim_sopt2_timesrc;
         sim_sopt2_rmiisrc;
         sim_sopt2_usbregen;
         sim_sopt2_usbslsrc
         ">
      <setTemplate variables="%(v)"
            linePadding="xxx"
      ><![CDATA[
         \t   /**
         \t    * Constructor for %description
         \t    *
         \t    * @tparam   Types
         \t    * @param    rest
         \t    *
         %paramDescription
         \t    */
         \t   template <typename... Types>
         \t   constexpr Init(%params, Types... rest) : Init(rest...) {
         \t
         \t      %registerName |= %paramExpression;
         \t   }
         \t\n
      ]]></setTemplate>
   </for>
   <for keys="p" values="0;1;2;3" >
      <for keys="u" values="0;1;2;3" >
         <for keys="v"
            values="
                sim_sopt4_ftm%(p)flt%(u);
                sim_sopt4_ftm%(p)trg%(u)src;
                sim_sopt4_ftm%(p)ch%(u)src;
                sim_sopt4_tpm%(p)ch%(u)src">
            <setTemplate variables="%(v)"
                  linePadding="xxx"
            ><![CDATA[
               \t   /**
               \t    * Constructor for %description
               \t    *
               \t    * @tparam   Types
               \t    * @param    rest
               \t    *
               %paramDescription
               \t    */
               \t   template <typename... Types>
               \t   constexpr Init(%params, Types... rest) : Init(rest...) {
               \t
               \t      %registerName |= %paramExpression;
               \t   }
               \t\n
            ]]></setTemplate>
         </for>
      </for>
      <for keys="v"
         values="
             sim_sopt4_tpm%(p)clksel;
             sim_sopt4_ftm%(p)clksel">
         <setTemplate variables="%(v)"
            linePadding="xxx"
         ><![CDATA[
            \t   /**
            \t    * Constructor for %description
            \t    *
            \t    * @tparam   Types
            \t    * @param    rest
            \t    *
            %paramDescription
            \t    */
            \t   template <typename... Types>
            \t   constexpr Init(%params, Types... rest) : Init(rest...) {
            \t
            \t      %registerName |= %paramExpression;
            \t   }
            \t\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values=";0;1;2;3;4">
      <for keys="v"
         values="
             sim_sopt5_uart%(p)ode;
             sim_sopt5_uart%(p)rxsrc;
             sim_sopt5_uart%(p)txsrc;
             sim_sopt5_lpuart%(p)ode;
             sim_sopt5_lpuart%(p)rxsrc;
             sim_sopt5_lpuart%(p)txsrc">
         <setTemplate variables="%(v)"
                  linePadding="xxx"
         ><![CDATA[
            \t   /**
            \t    * Constructor for %description
            \t    *
            \t    * @tparam   Types
            \t    * @param    rest
            \t    *
            %paramDescription
            \t    */
            \t   template <typename... Types>
            \t   constexpr Init(%params, Types... rest) : Init(rest...) {
            \t
            \t      %registerName |= %paramExpression;
            \t   }
            \t\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values=";0;1">
      <setTemplate variables="sim_sopt7_adc%(p)trigger,sim_sopt7_adc%(p)trgsel"
         linePadding="xxx"
       ><![CDATA[
      \t   /**
      \t    * Constructor for %description
      \t    *
      \t    * @tparam   Types
      \t    * @param    rest
      \t    *
      %paramDescription
      \t    */
      \t   template <typename... Types>
      \t   constexpr Init(
      %params, Types... rest) : Init(rest...) {
      \t
      \t      %registerName |= %paramExpression;
      \t   }
      \t\n
      ]]></setTemplate>
   </for>
   <for keys="ch" values="0;1;2;3;4;5;6;7">
      <for keys="v"
         values="
             sim_sopt8_ftm0och%(ch)src;
             sim_sopt8_ftm3och%(ch)src">
         <setTemplate variables="%(v)"
            linePadding="xxx"
         ><![CDATA[
            \t   /**
            \t    * Constructor for %description
            \t    *
            \t    * @tparam   Types
            \t    * @param    rest
            \t    *
            %paramDescription
            \t    */
            \t   template <typename... Types>
            \t   constexpr Init(%params, Types... rest) : Init(rest...) {
            \t
            \t      %registerName |= %paramExpression;
            \t   }
            \t\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values="1;2">
      <for keys="fn" values="clksel;ch0src">
         <setTemplate variables="sim_sopt9_tpm%(p)%(fn)"
            linePadding="xxx"
         ><![CDATA[
            \t   /**
            \t    * Constructor for %description
            \t    *
            \t    * @tparam   Types
            \t    * @param    rest
            \t    *
            %paramDescription
            \t    */
            \t   template <typename... Types>
            \t   constexpr Init(%params, Types... rest) : Init(rest...) {
            \t
            \t      %registerName |= %paramExpression;
            \t   }
            \t\n
         ]]></setTemplate>
      </for>
   </for>
   <template ><![CDATA[
      \t};\n\n
   ]]></template>

 <!-- ========== DefaultInitValue =============================== -->

   <template key="DefaultInitValue" namespace="all" ><![CDATA[
      \t/**
      \t * Default value for Sim::DefaultInit
      \t * This value is created from Configure.usbdmProject settings (Peripheral Parameters->SIM)
      \t */
      \tstatic constexpr Init DefaultInitValue {\n
   ]]></template>
   <setTemplate key="DefaultInitValue" namespace="all"
      variables="
         sim_sopt2_pllfllsel,
         sim_sopt1_osc32kout,
         sim_sopt1_osc32ksel,
         sim_sopt1_usbpower,
         sim_sopt2_sdhcsrc,
         sim_sopt2_tpmsrc,
         sim_sopt2_flexiosrc,
         sim_sopt2_usbsrc,
         sim_sopt2_traceclksel,
         sim_sopt2_fbsl,
         sim_sopt2_clkoutsel,
         sim_sopt2_rtcclkoutsel,

         sim_sopt2_ptd7pad,
         sim_sopt2_emvsimsrc,
         sim_sopt2_timesrc,
         sim_sopt2_rmiisrc,

         sim_sopt2_usbregen,
         sim_sopt2_usbslsrc"
      terminator=","
      separator=","
   ><![CDATA[
      %initExpression\n
   ]]></setTemplate>
   <for keys="n" values=";0;1;2;3;4">
      <for keys="v"
         values="
             sim_sopt2_lpuart%(n)src;
             sim_sopt2_uart%(n)src"
             >
         <setTemplate key="DefaultInitValue" namespace="all"
            terminator=","
            separator=","
            variables="%(v)"
            ><![CDATA[
            %initExpression\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values="0;1;2;3" >
      <for keys="u" values="0;1;2;3" >
         <for keys="v"
            values="
                sim_sopt4_ftm%(p)flt%(u);
                sim_sopt4_ftm%(p)trg%(u)src;
                sim_sopt4_ftm%(p)ch%(u)src;
                sim_sopt4_tpm%(p)ch%(u)src">
            <setTemplate key="DefaultInitValue" namespace="all"
               terminator=","
               separator=","
               variables="%(v)"
            ><![CDATA[
               %initExpression\n
            ]]></setTemplate>
         </for>
      </for>
      <for keys="v"
         values="
             sim_sopt4_tpm%(p)clksel;
             sim_sopt4_ftm%(p)clksel">
         <setTemplate key="DefaultInitValue" namespace="all"
            terminator=","
            separator=","
            variables="%(v)"
         ><![CDATA[
            %initExpression\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values=";0;1;2;3;4">
      <for keys="v"
         values="
             sim_sopt5_uart%(p)ode;
             sim_sopt5_uart%(p)rxsrc;
             sim_sopt5_uart%(p)txsrc;
             sim_sopt5_lpuart%(p)ode;
             sim_sopt5_lpuart%(p)rxsrc;
             sim_sopt5_lpuart%(p)txsrc">
         <setTemplate key="DefaultInitValue" namespace="all"
            terminator=","
            separator=","
            variables="%(v)"
         ><![CDATA[
            %initExpression\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values=";0;1">
      <setTemplate key="DefaultInitValue" namespace="all"
         terminator=","
         separator=","
         variables="sim_sopt7_adc%(p)trigger,sim_sopt7_adc%(p)trgsel"
       ><![CDATA[
         %initExpression\n
      ]]></setTemplate>
   </for>
   <for keys="ch" values="0;1;2;3;4;5;6;7">
      <for keys="v"
         values="
             sim_sopt8_ftm0och%(ch)src;
             sim_sopt8_ftm3och%(ch)src">
         <setTemplate key="DefaultInitValue" namespace="all"
            terminator=","
            separator=","
            variables="%(v)"
            ><![CDATA[
            %initExpression\n
         ]]></setTemplate>
      </for>
   </for>
   <for keys="p" values="1;2">
      <for keys="fn" values="clksel;ch0src">
         <setTemplate key="DefaultInitValue" namespace="all"
            terminator=","
            separator=","
            variables="sim_sopt9_tpm%(p)%(fn)"
            ><![CDATA[
            %initExpression\n
         ]]></setTemplate>
      </for>
   </for>
   <template key="DefaultInitValue" namespace="all" ><![CDATA[
      \t};\n\n
   ]]></template>

 <!-- ========== Common =============================== -->
   <template key="DefaultInitValue" namespace="all" ><![CDATA[
      \tstatic void initRegs() {
      \t
      \t   DefaultInitValue.configure();
      \t};\n\n
   ]]></template>


</fragment>
